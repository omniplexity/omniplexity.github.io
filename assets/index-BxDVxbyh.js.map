{"version":3,"file":"index-BxDVxbyh.js","sources":["../../node_modules/preact/dist/preact.module.js","../../node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","../../node_modules/preact/hooks/dist/hooks.module.js","../../src/core/config/runtimeConfig.ts","../../src/core/config/featureFlags.ts","../../src/core/router/hashRouter.tsx","../../src/core/state/store.ts","../../src/core/api/endpoints.ts","../../src/core/api/errors.ts","../../src/core/api/http.ts","../../src/core/api/csrf.ts","../../src/core/auth/authApi.ts","../../src/core/auth/authStore.ts","../../src/core/prefs/uiPrefsStore.ts","../../src/core/providers/providerApi.ts","../../src/core/providers/providerStore.ts","../../src/components/Banner.tsx","../../src/components/ModelSettingsForm.tsx","../../src/components/SettingsDrawer.tsx","../../src/components/Layout.tsx","../../src/components/ErrorScreen.tsx","../../src/routes/login.tsx","../../src/components/MessageList.tsx","../../src/components/ChatComposer.tsx","../../src/core/api/sse.ts","../../src/core/chat/chatApi.ts","../../src/core/chat/chatController.ts","../../src/core/chat/chatStore.ts","../../src/components/panels/MemoryPanel.tsx","../../src/components/panels/KnowledgePanel.tsx","../../src/components/panels/VoicePanel.tsx","../../src/components/panels/ToolsPanel.tsx","../../src/components/PanelDock.tsx","../../src/routes/chat.tsx","../../src/routes/settings.tsx","../../src/routes/admin.tsx","../../src/core/api/opsDuckdnsApi.ts","../../src/routes/ops.tsx","../../src/core/conversation/conversationApi.ts","../../src/core/conversation/conversationStore.ts","../../src/components/ConversationSidebar.tsx","../../src/app.tsx","../../src/main.tsx"],"sourcesContent":["var n,l,u,t,i,o,r,e,f,c,s,a,h,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,d=Array.isArray;function w(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,o,r,e={};for(r in u)\"key\"==r?i=u[r]:\"ref\"==r?o=u[r]:e[r]=u[r];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===e[r]&&(e[r]=l.defaultProps[r]);return m(l,e,i,o,null)}function m(n,t,i,o,r){var e={type:n,props:t,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==r?++u:r,__i:-1,__u:0};return null==r&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||o!=l.debounceRendering)&&((o=l.debounceRendering)||r)($)}function $(){for(var n,u,t,o,r,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,o=void 0,r=(o=(u=n).__v).__e,f=[],c=[],u.__P&&((t=w({},o)).__v=o.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,o,u.__n,u.__P.namespaceURI,32&o.__u?[r]:null,f,null==r?S(o):r,!!(32&o.__u),c),t.__v=o.__v,t.__.__k[t.__i]=t,N(f,t,c),o.__e=o.__=null,t.__e!=r&&C(t)));$.__r=0}function I(n,l,u,t,i,o,r,e,f,c,s){var a,h,y,d,w,g,_,m=t&&t.__k||v,b=l.length;for(f=P(u,l,m,f,b),a=0;a<b;a++)null!=(y=u.__k[a])&&(h=-1==y.__i?p:m[y.__i]||p,y.__i=a,g=O(n,y,h,i,o,r,e,f,c,s),d=y.__e,y.ref&&h.ref!=y.ref&&(h.ref&&B(h.ref,null,y),s.push(y.ref,y.__c||d,y)),null==w&&null!=d&&(w=d),(_=!!(4&y.__u))||h.__k===y.__k?f=A(y,f,n,_):\"function\"==typeof y.type&&void 0!==g?f=g:d&&(f=d.nextSibling),y.__u&=-7);return u.__e=w,f}function P(n,l,u,t,i){var o,r,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),o=0;o<i;o++)null!=(r=l[o])&&\"boolean\"!=typeof r&&\"function\"!=typeof r?(\"string\"==typeof r||\"number\"==typeof r||\"bigint\"==typeof r||r.constructor==String?r=n.__k[o]=m(null,r,null,null,null):d(r)?r=n.__k[o]=m(k,{children:r},null,null,null):void 0===r.constructor&&r.__b>0?r=n.__k[o]=m(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):n.__k[o]=r,f=o+h,r.__=n,r.__b=n.__b+1,e=null,-1!=(c=r.__i=L(r,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof r.type&&(r.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,r.__u|=4))):n.__k[o]=null;if(a)for(o=0;o<s;o++)null!=(e=u[o])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),D(e,e));return t}function A(n,l,u,t){var i,o;if(\"function\"==typeof n.type){for(i=n.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=n,l=A(i[o],l,u,t));return l}n.__e!=l&&(t&&(l&&n.type&&!l.parentNode&&(l=S(n)),u.insertBefore(n.__e,l||null)),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(d(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,o,r,e=n.key,f=n.type,c=l[u],s=null!=c&&0==(2&c.__u);if(null===c&&null==e||s&&e==c.key&&f==c.type)return u;if(t>(s?1:0))for(i=u-1,o=u+1;i>=0||o<l.length;)if(null!=(c=l[r=i>=0?i--:o++])&&0==(2&c.__u)&&e==c.key&&f==c.type)return r;return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||y.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var o,r;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])o=l!=(l=l.replace(f,\"$1\")),r=l.toLowerCase(),l=r in n||\"onFocusOut\"==l||\"onFocusIn\"==l?r.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,o?a:s,o)):n.removeEventListener(l,o?a:s,o);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,o,r,e,f,c,s){var a,h,p,v,y,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(void 0!==u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),r=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=E),C&&C.sub(h),h.state||(h.state={}),h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=w({},h.__s)),w(h.__s,j.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),u.__v==t.__v||!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(v,y,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=w(w({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,y)),L=a,null!=a&&a.type===k&&null==a.key&&(L=V(a.props.children)),f=I(n,d(L)?L:[L],u,t,i,o,r,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=r)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;r[r.indexOf(f)]=null,u.__e=f}else{for(T=r.length;T--;)g(r[T]);z(u)}else u.__e=t.__e,u.__k=t.__k,n.then||z(u);l.__e(n,u,t)}else null==r&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=q(t.__e,u,t,i,o,r,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(z)}function N(n,u,t){for(var i=0;i<t.length;i++)B(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function V(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:d(n)?n.map(V):w({},n)}function q(u,t,i,o,r,e,f,c,s){var a,h,v,y,w,_,m,b=i.props||p,k=t.props,x=t.type;if(\"svg\"==x?r=\"http://www.w3.org/2000/svg\":\"math\"==x?r=\"http://www.w3.org/1998/Math/MathML\":r||(r=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((w=e[a])&&\"setAttribute\"in w==!!x&&(x?w.localName==x:3==w.nodeType)){u=w,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(r,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(w=u.attributes[a]).name]=w.value;for(a in b)if(w=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)v=w;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,w,r)}for(a in k)w=k[a],\"children\"==a?y=w:\"dangerouslySetInnerHTML\"==a?h=w:\"value\"==a?_=w:\"checked\"==a?m=w:c&&\"function\"!=typeof w||b[a]===w||j(u,a,w,b[a],r);if(h)c||v&&(h.__html==v.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(v&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,d(y)?y:[y],t,i,o,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":r,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],r),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],r))}return u}function B(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function D(n,u,t){var i,o;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||B(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(o=0;o<i.length;o++)i[o]&&D(i[o],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function E(n,l,u){return this.constructor(n,u)}function G(u,t,i){var o,r,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),r=(o=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!o&&i||t).__k=_(k,null,[u]),r||p,p,t.namespaceURI,!o&&i?[i]:r?null:t.firstChild?n.call(t.childNodes):null,e,!o&&i?i:r?r.__e:t.firstChild,o,f),N(e,u,f)}function J(n,l){G(n,l,J)}function K(l,u,t){var i,o,r,e,f=w({},l.props);for(r in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==r?i=u[r]:\"ref\"==r?o=u[r]:f[r]=void 0===u[r]&&null!=e?e[r]:u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,o||l.ref,null)}function Q(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=v.slice,l={__e:function(n,l,u,t){for(var i,o,r;l=l.__;)if((i=l.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(n)),r=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),r=i.__d),r)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&void 0===n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=w({},this.state),\"function\"==typeof n&&(n=n(w({},u),this.props)),n&&w(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],r=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,K as cloneElement,Q as createContext,_ as createElement,b as createRef,_ as h,J as hydrate,t as isValidElement,l as options,G as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(t=function(r){return null!==r&&\"object\"==typeof r&&\"function\"==typeof r.valueOf?r.valueOf():r}(t),\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),s=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(s=\"px;\"),i=i+l+\":\"+a+s}}return e+'=\"'+n(i)+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(\"\"+t)+'\"'}function s(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=s(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,s as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,35);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","export type RuntimeConfig = {\n  BACKEND_BASE_URL: string;\n  FEATURE_FLAGS?: Record<string, boolean>;\n};\n\nlet _cfg: RuntimeConfig | null = null;\n\nexport function setRuntimeConfig(cfg: RuntimeConfig) {\n  _cfg = {\n    ...cfg,\n    BACKEND_BASE_URL: normalizeBaseUrl(cfg.BACKEND_BASE_URL)\n  };\n}\n\nexport function getRuntimeConfig(): RuntimeConfig {\n  if (!_cfg) throw new Error(\"Runtime config not set\");\n  return _cfg;\n}\n\nexport function normalizeBaseUrl(u: string): string {\n  const trimmed = (u ?? \"\").trim();\n  if (!trimmed) throw new Error(\"BACKEND_BASE_URL is empty\");\n  // remove trailing slash\n  return trimmed.endsWith(\"/\") ? trimmed.slice(0, -1) : trimmed;\n}\n\nexport function __resetRuntimeConfigForTest(): void {\n  _cfg = null;\n}\n\nexport async function loadRuntimeConfig(): Promise<RuntimeConfig> {\n  const url = `./runtime-config.json?ts=${Date.now()}`;\n  const res = await fetch(url, { cache: \"no-store\" });\n  if (!res.ok) throw new Error(`Missing runtime-config.json (${res.status})`);\n  const cfg = (await res.json()) as RuntimeConfig;\n  if (!cfg?.BACKEND_BASE_URL) throw new Error(\"runtime-config.json missing BACKEND_BASE_URL\");\n  return {\n    BACKEND_BASE_URL: cfg.BACKEND_BASE_URL,\n    FEATURE_FLAGS: cfg.FEATURE_FLAGS ?? {}\n  };\n}\n","type Flags = {\n  memoryPanel: boolean;\n  knowledgePanel: boolean;\n  voice: boolean;\n  tools: boolean;\n  adminOps: boolean;\n};\n\nconst DEFAULT_FLAGS: Flags = {\n  memoryPanel: false,\n  knowledgePanel: false,\n  voice: false,\n  tools: false,\n  adminOps: false\n};\n\nlet _flags: Flags = { ...DEFAULT_FLAGS };\n\nexport function setFlagsFromRuntime(cfg: { FEATURE_FLAGS?: Record<string, boolean> }) {\n  const f = cfg.FEATURE_FLAGS ?? {};\n  _flags = {\n    memoryPanel: Boolean(f.memoryPanel),\n    knowledgePanel: Boolean(f.knowledgePanel),\n    voice: Boolean(f.voice),\n    tools: Boolean(f.tools),\n    adminOps: Boolean(f.adminOps)\n  };\n}\n\nexport function getFlags(): Flags {\n  return _flags;\n}\n","import { useEffect, useState } from \"preact/hooks\";\n\nfunction getHashPath(): string {\n  // Expecting \"#/path\". If missing, default to \"/login\".\n  const raw = window.location.hash || \"\";\n  const h = raw.startsWith(\"#\") ? raw.slice(1) : raw;\n  if (!h || h === \"/\") return \"/login\";\n  return h.startsWith(\"/\") ? h : `/${h}`;\n}\n\nexport function navigate(to: string) {\n  const path = to.startsWith(\"/\") ? to : `/${to}`;\n  window.location.hash = `#${path}`;\n}\n\nexport function useHashLocation(): [string, (to: string) => void] {\n  const [path, setPath] = useState<string>(() => getHashPath());\n\n  useEffect(() => {\n    const onChange = () => setPath(getHashPath());\n    window.addEventListener(\"hashchange\", onChange);\n    return () => window.removeEventListener(\"hashchange\", onChange);\n  }, []);\n\n  return [path, navigate];\n}\n\nexport function Link(props: { to: string; class?: string; children: any }) {\n  const href = `#${props.to.startsWith(\"/\") ? props.to : `/${props.to}`}`;\n  return (\n    <a class={props.class} href={href}>\n      {props.children}\n    </a>\n  );\n}\n","export type Unsubscribe = () => void;\n\nexport type Store<T> = {\n  get: () => T;\n  set: (next: T) => void;\n  patch: (partial: Partial<T>) => void;\n  subscribe: (fn: () => void) => Unsubscribe;\n};\n\nexport function createStore<T extends object>(initial: T): Store<T> {\n  let value = initial;\n  const subs = new Set<() => void>();\n\n  function emit() {\n    for (const fn of subs) fn();\n  }\n\n  return {\n    get: () => value,\n    set: (next: T) => {\n      value = next;\n      emit();\n    },\n    patch: (partial: Partial<T>) => {\n      value = { ...value, ...partial };\n      emit();\n    },\n    subscribe: (fn: () => void) => {\n      subs.add(fn);\n      return () => subs.delete(fn);\n    }\n  };\n}\n","// OmniAI v1 API - Canonical endpoints only\n// Fallbacks removed for production stability\nexport const endpoints = {\n  // Authentication\n  meta: [\"/v1/meta\"],\n  csrfBootstrap: [\"/v1/auth/csrf/bootstrap\"],\n  me: [\"/v1/auth/me\"],\n  login: [\"/v1/auth/login\"],\n  logout: [\"/v1/auth/logout\"],\n\n  // Chat (streaming + retry/cancel)\n  chatStream: [\"/v1/chat\"],\n  chatStreamEvents: [\"/v1/chat/stream\"],\n  chatRetry: [\"/v1/chat/retry\"],\n  chatCancel: [\"/v1/chat/cancel\"],\n\n  // Conversations\n  conversations: [\"/v1/conversations\"],\n  conversationGet: [\"/v1/conversations/{id}\"],\n  conversationMessages: [\"/v1/conversations/{id}/messages\"],\n  conversationRename: [\"/v1/conversations/{id}\"],\n  conversationDelete: [\"/v1/conversations/{id}\"],\n  conversationBranch: [\"/v1/conversations/{id}/branch\"],\n\n  // Providers\n  providers: [\"/v1/providers\"],\n  models: [\"/v1/models\"],\n\n  // Memory\n  memory: [\"/v1/memory\"],\n  memorySearch: [\"/v1/memory/search\"],\n\n  // Tools\n  tools: [\"/v1/tools\"],\n  toolsExecute: [\"/v1/tools/execute\"],\n\n  // Ops (admin-only)\n  opsDuckdnsStatus: [\"/v1/ops/duckdns/status\"],\n  opsDuckdnsLogs: [\"/v1/ops/duckdns/logs\"],\n  opsDuckdnsUpdate: [\"/v1/ops/duckdns/update\"],\n  opsDuckdnsTest: [\"/v1/ops/duckdns/test\"],\n};\n\nexport function conversationEndpoint(id: string): string[] {\n  return [`/v1/conversations/${id}`];\n}\n\nexport function conversationMessagesEndpoint(conversationId: string): string[] {\n  return [`/v1/conversations/${conversationId}/messages`];\n}\n","export type ApiErrorCode =\n  | \"network_error\"\n  | \"timeout\"\n  | \"unauthorized\"\n  | \"forbidden\"\n  | \"csrf_failed\"\n  | \"rate_limited\"\n  | \"server_error\"\n  | \"unknown\";\n\nexport class ApiError extends Error {\n  code: ApiErrorCode;\n  status?: number;\n  detail?: unknown;\n\n  constructor(code: ApiErrorCode, message: string, status?: number, detail?: unknown) {\n    super(message);\n    this.code = code;\n    this.status = status;\n    this.detail = detail;\n  }\n}\n","import { getRuntimeConfig } from \"../config/runtimeConfig\";\nimport { ApiError } from \"./errors\";\n\nexport type HttpMethod = \"GET\" | \"POST\" | \"PUT\" | \"PATCH\" | \"DELETE\";\n\nexport async function fetchWithTimeout(\n  url: string,\n  init: RequestInit & { timeoutMs?: number } = {}\n): Promise<Response> {\n  const timeoutMs = init.timeoutMs ?? 30000;\n\n  const ctrl = new AbortController();\n  const signal = init.signal ?? ctrl.signal;\n\n  let t: any = null;\n  if (timeoutMs > 0) {\n    t = setTimeout(() => ctrl.abort(), timeoutMs);\n  }\n\n  try {\n    const res = await fetch(url, { ...init, signal });\n    return res;\n  } catch (e: any) {\n    if (e?.name === \"AbortError\") throw new ApiError(\"timeout\", \"Request timed out\");\n    throw new ApiError(\"network_error\", \"Network error\", undefined, String(e?.message ?? e));\n  } finally {\n    if (t) clearTimeout(t);\n  }\n}\n\nexport async function tryPaths<T>(\n  paths: string[],\n  fn: (absoluteUrl: string) => Promise<T>\n): Promise<T> {\n  const { BACKEND_BASE_URL } = getRuntimeConfig();\n  let lastErr: unknown;\n\n  for (const path of paths) {\n    try {\n      return await fn(`${BACKEND_BASE_URL}${path}`);\n    } catch (e) {\n      lastErr = e;\n    }\n  }\n  throw lastErr ?? new ApiError(\"unknown\", \"All endpoint paths failed\");\n}\n\nexport async function readErrorBody(res: Response): Promise<string> {\n  try {\n    return await res.text();\n  } catch {\n    return \"\";\n  }\n}\n\nexport function classifyHttpError(res: Response): ApiError {\n  if (res.status === 401) return new ApiError(\"unauthorized\", \"Unauthorized\", 401);\n  if (res.status === 403) return new ApiError(\"forbidden\", \"Forbidden\", 403);\n  if (res.status === 429) return new ApiError(\"rate_limited\", \"Rate limited\", 429);\n  if (res.status >= 500) return new ApiError(\"server_error\", `Server error (${res.status})`, res.status);\n  return new ApiError(\"unknown\", `HTTP ${res.status}`, res.status);\n}\n","import { endpoints } from \"./endpoints\";\nimport { fetchWithTimeout, readErrorBody, tryPaths } from \"./http\";\n\nlet _csrfToken: string | null = null;\n\nexport function getCsrfToken(): string | null {\n  return _csrfToken;\n}\n\nexport function clearCsrfToken() {\n  _csrfToken = null;\n}\n\nexport async function ensureCsrfToken(): Promise<void> {\n  if (_csrfToken) return;\n\n  const res = await tryPaths(endpoints.csrfBootstrap, async (url) => {\n    return fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { \"Accept\": \"application/json\" },\n      timeoutMs: 15000\n    });\n  });\n\n  if (!res.ok) {\n    const body = await readErrorBody(res);\n    throw new Error(`CSRF bootstrap failed (${res.status}): ${body}`);\n  }\n\n  const headerToken = res.headers.get(\"x-csrf-token\");\n  if (headerToken) _csrfToken = headerToken;\n\n  const text = await res.text();\n  try {\n    const json = JSON.parse(text);\n    if (typeof json?.csrf_token === \"string\") _csrfToken = json.csrf_token;\n    if (typeof json?.token === \"string\") _csrfToken = json.token;\n  } catch {\n    // non-JSON is fine\n  }\n}\n","import { endpoints } from \"../api/endpoints\";\nimport { ApiError } from \"../api/errors\";\nimport { ensureCsrfToken, getCsrfToken, clearCsrfToken } from \"../api/csrf\";\nimport { classifyHttpError, fetchWithTimeout, readErrorBody, tryPaths } from \"../api/http\";\n\nexport type MetaResponse = {\n  authenticated?: boolean;\n  user?: { id: string; username: string; role?: string; is_admin?: boolean };\n  role?: string;\n  auth?: {\n    authenticated?: boolean;\n    role?: string;\n    user?: { id: string; username: string; role?: string; is_admin?: boolean };\n  };\n};\n\nexport async function getMeta(): Promise<MetaResponse> {\n  return tryPaths(endpoints.meta, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { \"Accept\": \"application/json\" },\n      timeoutMs: 15000\n    });\n\n    if (res.status === 401) throw new ApiError(\"unauthorized\", \"Unauthorized\", 401);\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw new ApiError(\"server_error\", `Meta failed (${res.status})`, res.status, body);\n    }\n    return await res.json();\n  });\n}\n\nexport async function login(body: { username: string; password: string; invite_code?: string }) {\n  await ensureCsrfToken();\n\n  return tryPaths(endpoints.login, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify(body),\n      timeoutMs: 30000\n    });\n\n    if (!res.ok) {\n      if (res.status === 403 || res.status === 419) clearCsrfToken();\n      const bodyText = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `Login failed (${res.status})`, res.status, bodyText)\n        : new ApiError(\"unknown\", `Login failed (${res.status})`, res.status, bodyText);\n    }\n    return await res.json().catch(() => ({}));\n  });\n}\n\nexport async function logout() {\n  await ensureCsrfToken();\n\n  return tryPaths(endpoints.logout, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      timeoutMs: 15000\n    });\n\n    return res.ok;\n  });\n}\n","import { createStore } from \"../state/store\";\nimport * as authApi from \"./authApi\";\n\nexport type AuthStatus = \"unknown\" | \"authenticated\" | \"anonymous\";\n\nexport type AuthState = {\n  status: AuthStatus;\n  user?: { id: string; username: string; role?: string };\n  role?: string;\n  lastError?: string;\n};\n\nexport const authStore = createStore<AuthState>({\n  status: \"unknown\"\n});\n\nfunction normalizeMeta(meta: authApi.MetaResponse): { authenticated: boolean; user?: any; role?: string } {\n  const authenticated =\n    Boolean(meta?.authenticated ?? meta?.auth?.authenticated ?? meta?.user);\n\n  const user = meta?.user ?? meta?.auth?.user;\n  const roleFromBool = user?.is_admin === true ? \"admin\" : undefined;\n  const role = meta?.role ?? meta?.user?.role ?? meta?.auth?.role ?? user?.role ?? roleFromBool;\n  return { authenticated, user, role };\n}\n\nexport async function hydrateAuth(): Promise<void> {\n  authStore.patch({ status: \"unknown\", lastError: undefined });\n\n  try {\n    const meta = await authApi.getMeta();\n    const n = normalizeMeta(meta);\n    authStore.patch({\n      status: n.authenticated ? \"authenticated\" : \"anonymous\",\n      user: n.user,\n      role: n.role\n    });\n  } catch (e: any) {\n    const msg = String(e?.message ?? e);\n    const isUnauthorized = String(e?.code ?? \"\").includes(\"unauthorized\") || String(e?.status ?? \"\") === \"401\";\n    authStore.patch({\n      status: isUnauthorized ? \"anonymous\" : \"anonymous\",\n      user: undefined,\n      role: undefined,\n      lastError: isUnauthorized ? undefined : msg\n    });\n  }\n}\n\nexport async function doLogin(params: { username: string; password: string; invite_code?: string }) {\n  authStore.patch({ lastError: undefined });\n  await authApi.login(params);\n  await hydrateAuth();\n}\n\nexport async function doLogout() {\n  authStore.patch({ lastError: undefined });\n  await authApi.logout();\n  authStore.set({ status: \"anonymous\" });\n}\n","import { createStore } from \"../state/store\";\n\nexport type UiPrefs = {\n  // null = auto (backend decides)\n  providerId: string | null;\n  modelId: string | null;\n\n  temperature: number; // 0..2\n  topP: number;        // 0..1\n  maxTokens: number;   // 1..8192 (clamped)\n\n  // Phase 5: panel dock UI state (non-sensitive)\n  panelDockOpen: boolean;\n  activePanel: \"memory\" | \"knowledge\" | \"voice\" | \"tools\";\n};\n\nconst STORAGE_KEY = \"omniai.uiPrefs.v1\";\n\nconst DEFAULTS: UiPrefs = {\n  providerId: null,\n  modelId: null,\n  temperature: 0.7,\n  topP: 1.0,\n  maxTokens: 1024,\n  panelDockOpen: false,\n  activePanel: \"memory\"\n};\n\nfunction clamp(n: number, lo: number, hi: number) {\n  return Math.max(lo, Math.min(hi, n));\n}\n\nfunction sanitize(p: Partial<UiPrefs>): UiPrefs {\n  return {\n    providerId: typeof p.providerId === \"string\" ? p.providerId : null,\n    modelId: typeof p.modelId === \"string\" ? p.modelId : null,\n    temperature: clamp(Number(p.temperature ?? DEFAULTS.temperature), 0, 2),\n    topP: clamp(Number(p.topP ?? DEFAULTS.topP), 0, 1),\n    maxTokens: clamp(Math.floor(Number(p.maxTokens ?? DEFAULTS.maxTokens)), 1, 8192),\n    panelDockOpen: Boolean(p.panelDockOpen ?? DEFAULTS.panelDockOpen),\n    activePanel:\n      p.activePanel === \"memory\" || p.activePanel === \"knowledge\" || p.activePanel === \"voice\" || p.activePanel === \"tools\"\n        ? p.activePanel\n        : DEFAULTS.activePanel\n  };\n}\n\nfunction load(): UiPrefs {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return DEFAULTS;\n    const parsed = JSON.parse(raw) as Partial<UiPrefs>;\n    return sanitize({ ...DEFAULTS, ...parsed });\n  } catch {\n    return DEFAULTS;\n  }\n}\n\nfunction save(v: UiPrefs) {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(v));\n  } catch {\n    // ignore (storage may be disabled)\n  }\n}\n\nexport const uiPrefsStore = createStore<UiPrefs>(load());\n\nexport function setPrefs(partial: Partial<UiPrefs>) {\n  const next = sanitize({ ...uiPrefsStore.get(), ...partial });\n  uiPrefsStore.set(next);\n  save(next);\n}\n\nexport function resetPrefs() {\n  uiPrefsStore.set(DEFAULTS);\n  save(DEFAULTS);\n}\n","import { endpoints } from \"../api/endpoints\";\nimport { fetchWithTimeout, tryPaths } from \"../api/http\";\nimport type { ProviderInfo, ModelInfo } from \"./types\";\n\n// Flexible normalization: supports a variety of backend responses without requiring changes.\nfunction normStr(x: any, fallback: string) {\n  return typeof x === \"string\" && x.trim() ? x.trim() : fallback;\n}\n\nfunction normalizeModel(x: any): ModelInfo | null {\n  const id = normStr(x?.id ?? x?.model_id ?? x?.name, \"\");\n  const name = normStr(x?.name ?? x?.display_name ?? x?.id, id);\n  if (!id) return null;\n\n  const ctx = x?.context_length ?? x?.contextLength ?? x?.ctx_len ?? x?.n_ctx;\n  const contextLength = typeof ctx === \"number\" ? ctx : (typeof ctx === \"string\" ? Number(ctx) : undefined);\n\n  return { id, name, contextLength };\n}\n\nfunction normalizeProvider(x: any): ProviderInfo | null {\n  const id = normStr(x?.id ?? x?.provider_id ?? x?.name, \"\");\n  const name = normStr(x?.name ?? x?.display_name ?? x?.id, id);\n  if (!id) return null;\n\n  const modelsRaw = x?.models ?? x?.model_list ?? x?.items ?? [];\n  const models = Array.isArray(modelsRaw)\n    ? modelsRaw.map(normalizeModel).filter(Boolean) as ModelInfo[]\n    : [];\n\n  return { id, name, models };\n}\n\nfunction wrapFlatModels(models: ModelInfo[]): ProviderInfo[] {\n  // If backend only returns models, expose as a single \"auto\" provider bucket\n  return [{ id: \"auto\", name: \"Auto\", models }];\n}\n\nexport async function listProviders(): Promise<ProviderInfo[]> {\n  // Try /providers first\n  try {\n    const data = await tryPaths(endpoints.providers, async (url) => {\n      const res = await fetchWithTimeout(url, {\n        method: \"GET\",\n        credentials: \"include\",\n        headers: { \"Accept\": \"application/json\" },\n        timeoutMs: 15000\n      });\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n      return res.json();\n    });\n\n    const providersRaw =\n      Array.isArray(data) ? data :\n      Array.isArray((data as any)?.providers) ? (data as any).providers :\n      Array.isArray((data as any)?.items) ? (data as any).items :\n      null;\n\n    if (providersRaw) {\n      const providers = providersRaw.map(normalizeProvider).filter(Boolean) as ProviderInfo[];\n      if (providers.length) return providers;\n    }\n\n    // Maybe the providers endpoint returns {models:[...]} only\n    const modelsRaw = (data as any)?.models;\n    if (Array.isArray(modelsRaw)) {\n      const models = modelsRaw.map(normalizeModel).filter(Boolean) as ModelInfo[];\n      return wrapFlatModels(models);\n    }\n  } catch {\n    // fallthrough to /models\n  }\n\n  // Fallback: /models\n  const modelData = await tryPaths(endpoints.models, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { \"Accept\": \"application/json\" },\n      timeoutMs: 15000\n    });\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\n    return res.json();\n  });\n\n  const modelsRaw =\n    Array.isArray(modelData) ? modelData :\n    Array.isArray((modelData as any)?.models) ? (modelData as any).models :\n    Array.isArray((modelData as any)?.items) ? (modelData as any).items :\n    [];\n\n  const models = (Array.isArray(modelsRaw) ? modelsRaw : [])\n    .map(normalizeModel)\n    .filter(Boolean) as ModelInfo[];\n\n  return wrapFlatModels(models);\n}\n","import { createStore } from \"../state/store\";\nimport type { ProviderInfo } from \"./types\";\nimport { listProviders } from \"./providerApi\";\n\nexport type ProviderState = {\n  loading: boolean;\n  providers: ProviderInfo[];\n  error?: string;\n  loadedAt?: number;\n};\n\nexport const providerStore = createStore<ProviderState>({\n  loading: false,\n  providers: []\n});\n\nexport async function hydrateProviders(): Promise<void> {\n  if (providerStore.get().loading) return;\n  providerStore.patch({ loading: true, error: undefined });\n\n  try {\n    const providers = await listProviders();\n    providerStore.patch({ loading: false, providers, loadedAt: Date.now() });\n  } catch (e: any) {\n    providerStore.patch({\n      loading: false,\n      error: String(e?.message ?? e),\n      providers: []\n    });\n  }\n}\n","export function Banner(props: { kind: \"error\" | \"info\"; text: string }) {\n  return <div class={`banner ${props.kind}`} role={props.kind === \"error\" ? \"alert\" : \"status\"}>{props.text}</div>;\n}\n","import { useEffect, useMemo, useState } from \"preact/hooks\";\nimport { providerStore, hydrateProviders } from \"../core/providers/providerStore\";\nimport { uiPrefsStore, setPrefs, resetPrefs } from \"../core/prefs/uiPrefsStore\";\nimport type { ProviderInfo, ModelInfo } from \"../core/providers/types\";\nimport { Banner } from \"./Banner\";\n\nfunction useStore<T>(store: { get: () => T; subscribe: (fn: () => void) => () => void }) {\n  const [v, setV] = useState(store.get());\n  useEffect(() => store.subscribe(() => setV(store.get())), []);\n  return v;\n}\n\nfunction findProvider(providers: ProviderInfo[], id: string | null): ProviderInfo | null {\n  if (!providers.length) return null;\n  if (!id) return providers[0] ?? null;\n  return providers.find((p) => p.id === id) ?? null;\n}\n\nfunction findModel(provider: ProviderInfo | null, id: string | null): ModelInfo | null {\n  if (!provider) return null;\n  if (!provider.models.length) return null;\n  if (!id) return provider.models[0] ?? null;\n  return provider.models.find((m) => m.id === id) ?? null;\n}\n\nexport function ModelSettingsForm(props: { compact?: boolean }) {\n  const prefs = useStore(uiPrefsStore);\n  const provState = useStore(providerStore);\n\n  useEffect(() => {\n    void hydrateProviders();\n  }, []);\n\n  const provider = useMemo(\n    () => findProvider(provState.providers, prefs.providerId),\n    [provState.providers, prefs.providerId]\n  );\n\n  const models = provider?.models ?? [];\n  const model = useMemo(\n    () => findModel(provider, prefs.modelId),\n    [provider, prefs.modelId]\n  );\n\n  // Ensure prefs remain valid after providers load / change.\n  useEffect(() => {\n    if (!provState.providers.length) return;\n\n    const p = provider ?? provState.providers[0];\n    const m = p?.models?.[0] ?? null;\n\n    // If current selection doesn't exist, normalize to first available.\n    const providerValid = prefs.providerId ? provState.providers.some((x) => x.id === prefs.providerId) : true;\n    const modelValid =\n      !prefs.modelId ? true :\n      Boolean(p?.models?.some((x) => x.id === prefs.modelId));\n\n    if (!providerValid) setPrefs({ providerId: p?.id ?? null });\n    if (!modelValid) setPrefs({ modelId: m?.id ?? null });\n  }, [provState.providers.length]);\n\n  return (\n    <div class={props.compact ? \"settingsForm compact\" : \"settingsForm\"}>\n      <div class=\"settingsHeader\">\n        <div>\n          <div class=\"settingsTitle\">Model & chat settings</div>\n          <div class=\"muted\" style=\"font-size:12px;\">\n            Preferences are stored locally only (no chat content).\n          </div>\n        </div>\n        <div class=\"row\">\n          <button class=\"btn\" onClick={() => void hydrateProviders()} disabled={provState.loading}>\n            {provState.loading ? \"Loading…\" : \"Reload\"}\n          </button>\n          <button class=\"btn\" onClick={() => resetPrefs()}>\n            Defaults\n          </button>\n        </div>\n      </div>\n\n      {provState.error ? <Banner kind=\"error\" text={`Providers unavailable: ${provState.error}`} /> : null}\n\n      <div class=\"grid2\">\n        <div>\n          <label class=\"label\">Provider</label>\n          {provState.providers.length ? (\n            <select\n              class=\"select\"\n              value={prefs.providerId ?? \"\"}\n              onChange={(e) => {\n                const id = (e.target as any).value || null;\n                // If provider changes, reset model selection (so it stays valid).\n                setPrefs({ providerId: id, modelId: null });\n              }}\n            >\n              {/* empty => auto */}\n              <option value=\"\">Auto</option>\n              {provState.providers.map((p) => (\n                <option value={p.id}>{p.name}</option>\n              ))}\n            </select>\n          ) : (\n            <input\n              class=\"input\"\n              placeholder=\"Auto\"\n              value={prefs.providerId ?? \"\"}\n              onInput={(e) => setPrefs({ providerId: (e.target as any).value || null })}\n            />\n          )}\n        </div>\n\n        <div>\n          <label class=\"label\">Model</label>\n          {models.length ? (\n            <select\n              class=\"select\"\n              value={prefs.modelId ?? \"\"}\n              onChange={(e) => setPrefs({ modelId: (e.target as any).value || null })}\n            >\n              <option value=\"\">Auto</option>\n              {models.map((m) => (\n                <option value={m.id}>{m.name}</option>\n              ))}\n            </select>\n          ) : (\n            <input\n              class=\"input\"\n              placeholder={model?.name ?? \"Auto\"}\n              value={prefs.modelId ?? \"\"}\n              onInput={(e) => setPrefs({ modelId: (e.target as any).value || null })}\n            />\n          )}\n        </div>\n      </div>\n\n      <div class=\"grid3\">\n        <div>\n          <label class=\"label\">Temperature</label>\n          <input\n            class=\"input\"\n            type=\"number\"\n            min=\"0\"\n            max=\"2\"\n            step=\"0.05\"\n            value={prefs.temperature}\n            onInput={(e) => setPrefs({ temperature: Number((e.target as any).value) })}\n          />\n        </div>\n\n        <div>\n          <label class=\"label\">Top P</label>\n          <input\n            class=\"input\"\n            type=\"number\"\n            min=\"0\"\n            max=\"1\"\n            step=\"0.05\"\n            value={prefs.topP}\n            onInput={(e) => setPrefs({ topP: Number((e.target as any).value) })}\n          />\n        </div>\n\n        <div>\n          <label class=\"label\">Max tokens</label>\n          <input\n            class=\"input\"\n            type=\"number\"\n            min=\"1\"\n            max=\"8192\"\n            step=\"64\"\n            value={prefs.maxTokens}\n            onInput={(e) => setPrefs({ maxTokens: Number((e.target as any).value) })}\n          />\n        </div>\n      </div>\n\n      <div class=\"muted\" style=\"font-size:12px;margin-top:10px;\">\n        Current: {prefs.providerId ?? \"Auto\"} / {prefs.modelId ?? \"Auto\"}\n      </div>\n    </div>\n  );\n}\n","import { ModelSettingsForm } from \"./ModelSettingsForm\";\n\nexport function SettingsDrawer(props: { open: boolean; onClose: () => void }) {\n  if (!props.open) return null;\n\n  return (\n    <div class=\"drawerOverlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Settings\">\n      <div class=\"drawer\">\n        <div class=\"drawerTop\">\n          <div class=\"drawerTitle\">Quick settings</div>\n          <button class=\"btn\" onClick={props.onClose}>Close</button>\n        </div>\n        <div class=\"drawerBody\">\n          <ModelSettingsForm compact />\n        </div>\n      </div>\n      <div class=\"drawerBackdrop\" onClick={props.onClose} />\n    </div>\n  );\n}\n","import { useEffect, useState } from \"preact/hooks\";\nimport { authStore, doLogout } from \"../core/auth/authStore\";\nimport { uiPrefsStore } from \"../core/prefs/uiPrefsStore\";\nimport { SettingsDrawer } from \"./SettingsDrawer\";\n\nfunction useStore<T>(store: { get: () => T; subscribe: (fn: () => void) => () => void }) {\n  const [v, setV] = useState(store.get());\n  useEffect(() => store.subscribe(() => setV(store.get())), []);\n  return v;\n}\n\nexport function Layout(props: { nav: any; children: any; sidebar?: any }) {\n  const auth = useStore(authStore);\n  const prefs = useStore(uiPrefsStore);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n\n  return (\n    <div class=\"shell\">\n      <aside class=\"sidebar\">\n        <div class=\"brandRow\">\n          <div class=\"brand\">OmniAI</div>\n          <div class={`pill ${auth.status}`}>{auth.status}</div>\n        </div>\n\n        {props.sidebar ? (\n          <div class=\"sidebarContent\">\n            {props.sidebar}\n          </div>\n        ) : (\n          props.nav\n        )}\n\n        <div class=\"sidebarFooter muted\">\n          {auth.status === \"authenticated\" ? (\n            <button class=\"btn\" onClick={() => void doLogout()}>Logout</button>\n          ) : null}\n        </div>\n      </aside>\n\n      <main class=\"main\">\n        <div class=\"topbar\">\n          <div class=\"topbarTitle\">OmniAI</div>\n          <div class=\"topbarRight\">\n            <div class=\"topbarBadge mono\">\n              {prefs.providerId ?? \"Auto\"} / {prefs.modelId ?? \"Auto\"}\n            </div>\n            <button class=\"btn\" onClick={() => setDrawerOpen(true)} aria-label=\"Open settings\">\n              ⚙\n            </button>\n          </div>\n        </div>\n\n        <div class=\"content\">{props.children}</div>\n\n        <SettingsDrawer open={drawerOpen} onClose={() => setDrawerOpen(false)} />\n      </main>\n    </div>\n  );\n}\n","export function ErrorScreen(props: { title: string; detail: string; onRetry?: () => void }) {\n  return (\n    <div class=\"page center\">\n      <div class=\"card\">\n        <h1 class=\"h1\">{props.title}</h1>\n        <pre class=\"pre\">{props.detail}</pre>\n        {props.onRetry ? (\n          <button class=\"btn primary\" onClick={props.onRetry}>Retry</button>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","import { useState } from \"preact/hooks\";\nimport { Banner } from \"../components/Banner\";\nimport { getRuntimeConfig } from \"../core/config/runtimeConfig\";\nimport { doLogin, authStore, hydrateAuth } from \"../core/auth/authStore\";\nimport { navigate } from \"../core/router/hashRouter\";\n\nexport function LoginRoute() {\n  const cfg = getRuntimeConfig();\n\n  const [username, setU] = useState(\"\");\n  const [password, setP] = useState(\"\");\n  const [invite, setI] = useState(\"\");\n\n  const [busy, setBusy] = useState(false);\n  const [err, setErr] = useState<string | null>(null);\n\n  async function onSubmit(e: Event) {\n    e.preventDefault();\n    setErr(null);\n    setBusy(true);\n    try {\n      await doLogin({\n        username: username.trim(),\n        password,\n        invite_code: invite.trim() || undefined\n      });\n      const a = authStore.get();\n      if (a.status === \"authenticated\") navigate(\"/chat\");\n      else setErr(\"Login did not establish a session (check cookies / backend auth).\");\n    } catch (e: any) {\n      setErr(String(e?.message ?? e));\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function onRefreshSession() {\n    setErr(null);\n    setBusy(true);\n    try {\n      await hydrateAuth();\n      const a = authStore.get();\n      if (a.status === \"authenticated\") navigate(\"/chat\");\n    } catch (e: any) {\n      setErr(String(e?.message ?? e));\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div class=\"page pad\">\n      <div class=\"card wide\">\n        <h1 class=\"h1\">Login</h1>\n        <p class=\"muted\">Cookie session + CSRF protected login (invite-only).</p>\n\n        <div class=\"kv\">\n          <div class=\"k\">BACKEND_BASE_URL</div>\n          <div class=\"v mono\">{cfg.BACKEND_BASE_URL}</div>\n        </div>\n\n        {err ? <Banner kind=\"error\" text={err} /> : null}\n\n        <form class=\"form\" onSubmit={onSubmit}>\n          <label class=\"label\" for=\"u\">Username</label>\n          <input id=\"u\" class=\"input\" value={username} onInput={(e) => setU((e.target as HTMLInputElement).value)} />\n\n          <label class=\"label\" for=\"p\">Password</label>\n          <input id=\"p\" class=\"input\" type=\"password\" value={password} onInput={(e) => setP((e.target as HTMLInputElement).value)} />\n\n          <label class=\"label\" for=\"i\">Invite code (optional)</label>\n          <input id=\"i\" class=\"input\" value={invite} onInput={(e) => setI((e.target as HTMLInputElement).value)} />\n\n          <div class=\"row\">\n            <button class=\"btn primary\" disabled={busy || !username.trim() || !password}>\n              {busy ? \"Signing in…\" : \"Sign in\"}\n            </button>\n            <button type=\"button\" class=\"btn\" disabled={busy} onClick={() => void onRefreshSession()}>\n              Refresh session\n            </button>\n          </div>\n        </form>\n\n        <p class=\"muted\" style=\"margin-top:12px;\">\n          All requests go to the OmniAI backend only; no provider endpoints are contacted from the client.\n        </p>\n      </div>\n    </div>\n  );\n}\n","import type { ChatMessage } from \"../core/chat/types\";\n\nexport function MessageList(props: { messages: ChatMessage[] }) {\n  return (\n    <div class=\"messages\" role=\"log\" aria-live=\"polite\">\n      {props.messages.map((m) => (\n        <div class={`msg ${m.role}`}>\n          <div class=\"msgInner\">\n            <div class=\"msgRole\">{m.role}</div>\n            <div class=\"msgBody\">{m.content}</div>\n            {m.status ? <div class=\"msgMeta\">{m.status}</div> : null}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { useRef, useState } from \"preact/hooks\";\n\nexport function ChatComposer(props: {\n  streaming: boolean;\n  onSend: (text: string) => void | Promise<void>;\n  onStop: () => void;\n  onRetry: () => void | Promise<void>;\n}) {\n  const [text, setText] = useState(\"\");\n  const taRef = useRef<HTMLTextAreaElement>(null);\n\n  async function send() {\n    const t = text.trim();\n    if (!t) return;\n    setText(\"\");\n    await props.onSend(t);\n    taRef.current?.focus();\n  }\n\n  return (\n    <div class=\"composer\">\n      <textarea\n        ref={taRef}\n        class=\"textarea\"\n        rows={2}\n        value={text}\n        onInput={(e) => setText((e.target as any).value)}\n        placeholder=\"Message OmniAI…\"\n      />\n      <div class=\"composerRow\">\n        <button class=\"btn\" disabled={props.streaming} onClick={() => void props.onRetry()}>\n          Retry\n        </button>\n        {props.streaming ? (\n          <button class=\"btn danger\" onClick={() => props.onStop()}>\n            Stop\n          </button>\n        ) : (\n          <button class=\"btn primary\" disabled={!text.trim()} onClick={() => void send()}>\n            Send\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","export type SseFrame = { event: string; data: string };\n\nasync function readChunkWithAbort(\n  reader: ReadableStreamDefaultReader<Uint8Array>,\n  signal: AbortSignal\n): Promise<ReadableStreamReadResult<Uint8Array>> {\n  if (signal.aborted) throw new DOMException(\"Aborted\", \"AbortError\");\n\n  return await Promise.race([\n    reader.read(),\n    new Promise<never>((_, reject) => {\n      const onAbort = () => {\n        signal.removeEventListener(\"abort\", onAbort);\n        reject(new DOMException(\"Aborted\", \"AbortError\"));\n      };\n      signal.addEventListener(\"abort\", onAbort, { once: true });\n    }),\n  ]);\n}\n\nexport async function* parseSseResponse(\n  res: Response,\n  signal: AbortSignal\n): AsyncGenerator<SseFrame> {\n  if (!res.ok || !res.body) {\n    const t = await res.text().catch(() => \"\");\n    throw new Error(`SSE HTTP ${res.status}: ${t}`);\n  }\n\n  const reader = res.body.getReader();\n  const decoder = new TextDecoder(\"utf-8\");\n\n  let buf = \"\";\n  let event = \"message\";\n  let data = \"\";\n\n  const flush = (): SseFrame | null => {\n    if (!data) return null;\n    const out = { event, data: data.replace(/\\n$/, \"\") };\n    event = \"message\";\n    data = \"\";\n    return out;\n  };\n\n  while (true) {\n    if (signal.aborted) throw new DOMException(\"Aborted\", \"AbortError\");\n\n    const { value, done } = await readChunkWithAbort(reader, signal);\n    if (done) break;\n\n    buf += decoder.decode(value, { stream: true });\n\n    while (true) {\n      const idx = buf.indexOf(\"\\n\");\n      if (idx < 0) break;\n\n      const line = buf.slice(0, idx).replace(/\\r$/, \"\");\n      buf = buf.slice(idx + 1);\n\n      if (line === \"\") {\n        const out = flush();\n        if (out) yield out;\n        continue;\n      }\n      if (line.startsWith(\":\")) continue; // comment\n      if (line.startsWith(\"event:\")) {\n        event = line.slice(\"event:\".length).trim() || \"message\";\n        continue;\n      }\n      if (line.startsWith(\"data:\")) {\n        data += line.slice(\"data:\".length).trimStart() + \"\\n\";\n        continue;\n      }\n      // ignore id:, retry:\n    }\n  }\n\n  const out = flush();\n  if (out) yield out;\n}\n","import { endpoints } from \"../api/endpoints\";\nimport { tryPaths, fetchWithTimeout } from \"../api/http\";\nimport { ensureCsrfToken, getCsrfToken } from \"../api/csrf\";\nimport { parseSseResponse } from \"../api/sse\";\nimport type { ChatRequest, ChatStreamEvent } from \"./types\";\n\nfunction extractMeta(obj: any): { conversation_id?: string; run_id?: string } {\n  const cid = obj?.conversation_id ?? obj?.conversationId ?? obj?.conversation?.id;\n  const rid = obj?.run_id ?? obj?.runId ?? obj?.id;\n  return {\n    conversation_id: typeof cid === \"string\" ? cid : undefined,\n    run_id: typeof rid === \"string\" ? rid : undefined\n  };\n}\n\nfunction extractDelta(obj: any): string | null {\n  // Backend emits: message.delta { delta: \"...\" }\n  const d = obj?.delta ?? obj?.text ?? obj?.content;\n  return typeof d === \"string\" ? d : null;\n}\n\nfunction extractError(obj: any): string | null {\n  // Backend emits: error { message: \"...\", code: \"...\" }\n  const e = obj?.message ?? obj?.error ?? obj?.detail;\n  return typeof e === \"string\" ? e : null;\n}\n\n/**\n * Start a chat by creating a run, then stream events from /v1/chat/stream\n */\nexport async function* streamChat(\n  req: ChatRequest,\n  signal: AbortSignal\n): AsyncGenerator<ChatStreamEvent> {\n  await ensureCsrfToken();\n\n  // Step 1: POST /v1/chat to create a run (returns run_id)\n  const createRes = await tryPaths(endpoints.chatStream, async (url) => {\n    return fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({\n        conversation_id: req.conversation_id,\n        input: req.input,\n        provider: req.provider,\n        model: req.model,\n        settings: req.settings,\n        stream: true\n      }),\n      signal\n    });\n  });\n\n  if (!createRes.ok) {\n    const text = await createRes.text();\n    yield { type: \"error\", message: `HTTP ${createRes.status}: ${text}` };\n    return;\n  }\n\n  const createData = await createRes.json();\n  const runId = createData?.run_id ?? createData?.id;\n  \n  if (!runId) {\n    yield { type: \"error\", message: \"No run_id in response\" };\n    return;\n  }\n\n  yield { type: \"meta\", run_id: runId };\n\n  // Step 2: GET /v1/chat/stream?run_id=xxx to stream events\n  const streamUrl = `${endpoints.chatStreamEvents[0]}?run_id=${encodeURIComponent(runId)}`;\n  \n  const streamRes = await fetchWithTimeout(streamUrl, {\n    method: \"GET\",\n    credentials: \"include\",\n    headers: {\n      \"Accept\": \"text/event-stream\",\n      \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n    },\n    signal,\n    timeoutMs: 0 as any\n  });\n\n  for await (const frame of parseSseResponse(streamRes, signal)) {\n    const ev = frame.event || \"message\";\n    const raw = frame.data ?? \"\";\n\n    // Prefer JSON if possible.\n    let obj: any = null;\n    try {\n      obj = JSON.parse(raw);\n    } catch {\n      obj = null;\n    }\n\n    if (obj) {\n      // Handle canonical event: message with type:\"delta\" or type:\"full\"\n      if (ev === \"message\") {\n        const msgType = obj?.type;\n        \n        if (msgType === \"delta\") {\n          // Delta: append to assistant bubble\n          const delta = extractDelta(obj);\n          if (delta) {\n            yield { type: \"delta\", text: delta };\n          }\n          continue;\n        }\n        \n        if (msgType === \"full\") {\n          // Full message: replace content and optionally attach usage\n          yield { \n            type: \"full\", \n            content: obj?.content || \"\", \n            message_id: obj?.message_id,\n            usage: obj?.usage \n          };\n          continue;\n        }\n      }\n\n      // Legacy event name handling (backward compatibility)\n      if (ev === \"message.delta\" || ev === \"delta\") {\n        const delta = extractDelta(obj);\n        if (delta) {\n          yield { type: \"delta\", text: delta };\n        }\n        continue;\n      }\n\n      if (ev === \"message.final\" || ev === \"message.created\") {\n        // Message complete - emit done\n        yield { type: \"done\" };\n        continue;\n      }\n\n      if (ev === \"error\") {\n        const err = extractError(obj);\n        yield { type: \"error\", message: err || raw || \"Unknown error\" };\n        continue;\n      }\n\n      if (ev === \"run.status\") {\n        const status = obj?.status;\n        if (status === \"error\") {\n          yield { type: \"error\", message: obj?.error_message || \"Run failed\" };\n        } else if (status === \"cancelled\") {\n          yield { type: \"stopped\" };\n        } else if (status === \"completed\") {\n          yield { type: \"done\" };\n        }\n        continue;\n      }\n\n      if (ev === \"stopped\") {\n        yield { type: \"stopped\" };\n        continue;\n      }\n\n      // Meta extraction for any event\n      const meta = extractMeta(obj);\n      if (meta.conversation_id || meta.run_id) {\n        yield { type: \"meta\", ...meta };\n      }\n    }\n\n    // Non-JSON fallback by event name\n    if (ev === \"delta\" || ev === \"message\") yield { type: \"delta\", text: raw };\n    else if (ev === \"error\") yield { type: \"error\", message: raw || \"error\" };\n    else if (ev === \"done\") yield { type: \"done\" };\n    else if (ev === \"stopped\") yield { type: \"stopped\" };\n  }\n\n  // Ensure done is emitted if stream closes without explicit completion\n  yield { type: \"done\" };\n}\n\n/**\n * Retry a message in a conversation using the /v1/chat/retry endpoint\n */\nexport async function* retryChat(\n  conversationId: string,\n  messageId: string,\n  signal: AbortSignal\n): AsyncGenerator<ChatStreamEvent> {\n  await ensureCsrfToken();\n\n  // Step 1: POST /v1/chat/retry to create a retry run (returns run_id)\n  const retryRes = await tryPaths(endpoints.chatRetry, async (url) => {\n    return fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({\n        conversation_id: conversationId,\n        message_id: messageId\n      }),\n      signal\n    });\n  });\n\n  if (!retryRes.ok) {\n    const text = await retryRes.text();\n    yield { type: \"error\", message: `HTTP ${retryRes.status}: ${text}` };\n    return;\n  }\n\n  const retryData = await retryRes.json();\n  const runId = retryData?.run_id ?? retryData?.id;\n  \n  if (!runId) {\n    yield { type: \"error\", message: \"No run_id in retry response\" };\n    return;\n  }\n\n  yield { type: \"meta\", run_id: runId, conversation_id: conversationId };\n\n  // Step 2: GET /v1/chat/stream?run_id=xxx to stream events\n  const streamUrl = `${endpoints.chatStreamEvents[0]}?run_id=${encodeURIComponent(runId)}`;\n  \n  const streamRes = await fetchWithTimeout(streamUrl, {\n    method: \"GET\",\n    credentials: \"include\",\n    headers: {\n      \"Accept\": \"text/event-stream\",\n      \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n    },\n    signal,\n    timeoutMs: 0 as any\n  });\n\n  // Reuse the same event parsing logic from streamChat\n  for await (const frame of parseSseResponse(streamRes, signal)) {\n    const ev = frame.event || \"message\";\n    const raw = frame.data ?? \"\";\n\n    let obj: any = null;\n    try {\n      obj = JSON.parse(raw);\n    } catch {\n      obj = null;\n    }\n\n    if (obj) {\n      // Handle canonical event: message with type:\"delta\" or type:\"full\"\n      if (ev === \"message\") {\n        const msgType = obj?.type;\n        \n        if (msgType === \"delta\") {\n          const delta = extractDelta(obj);\n          if (delta) {\n            yield { type: \"delta\", text: delta };\n          }\n          continue;\n        }\n        \n        if (msgType === \"full\") {\n          yield { \n            type: \"full\", \n            content: obj?.content || \"\", \n            message_id: obj?.message_id,\n            usage: obj?.usage \n          };\n          continue;\n        }\n      }\n\n      // Legacy event name handling\n      if (ev === \"message.delta\" || ev === \"delta\") {\n        const delta = extractDelta(obj);\n        if (delta) {\n          yield { type: \"delta\", text: delta };\n        }\n        continue;\n      }\n\n      if (ev === \"message.final\" || ev === \"message.created\") {\n        yield { type: \"done\" };\n        continue;\n      }\n\n      if (ev === \"error\") {\n        const err = extractError(obj);\n        yield { type: \"error\", message: err || raw || \"Unknown error\" };\n        continue;\n      }\n\n      if (ev === \"run.status\") {\n        const status = obj?.status;\n        if (status === \"error\") {\n          yield { type: \"error\", message: obj?.error_message || \"Run failed\" };\n        } else if (status === \"cancelled\") {\n          yield { type: \"stopped\" };\n        } else if (status === \"completed\") {\n          yield { type: \"done\" };\n        }\n        continue;\n      }\n\n      if (ev === \"stopped\") {\n        yield { type: \"stopped\" };\n        continue;\n      }\n\n      const meta = extractMeta(obj);\n      if (meta.conversation_id || meta.run_id) {\n        yield { type: \"meta\", ...meta };\n      }\n    }\n\n    if (ev === \"delta\" || ev === \"message\") yield { type: \"delta\", text: raw };\n    else if (ev === \"error\") yield { type: \"error\", message: raw || \"error\" };\n    else if (ev === \"done\") yield { type: \"done\" };\n    else if (ev === \"stopped\") yield { type: \"stopped\" };\n  }\n\n  yield { type: \"done\" };\n}\n\n/**\n * Cancel a running stream (best-effort)\n */\nexport async function cancelChat(runId: string): Promise<void> {\n  await ensureCsrfToken();\n\n  await tryPaths(endpoints.chatCancel, async (url) => {\n    return fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({ run_id: runId }),\n      timeoutMs: 5000\n    });\n  });\n  // Ignore response - best-effort\n}\n\n// Optional best-effort history (safe if backend lacks these endpoints).\nexport async function tryLoadMessages(conversationId: string): Promise<any[] | null> {\n  const replace = (p: string) => p.replace(\"{id}\", encodeURIComponent(conversationId));\n\n  // Try /messages first\n  try {\n    const msgs = await tryPaths(endpoints.conversationMessages.map(replace), async (url) => {\n      const res = await fetchWithTimeout(url, {\n        method: \"GET\",\n        credentials: \"include\",\n        headers: { \"Accept\": \"application/json\" },\n        timeoutMs: 15000\n      });\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n      return res.json();\n    });\n    return Array.isArray(msgs) ? msgs : (Array.isArray((msgs as any)?.items) ? (msgs as any).items : null);\n  } catch {\n    // Try conversation detail as fallback\n    try {\n      const convo = await tryPaths(endpoints.conversationGet.map(replace), async (url) => {\n        const res = await fetchWithTimeout(url, {\n          method: \"GET\",\n          credentials: \"include\",\n          headers: { \"Accept\": \"application/json\" },\n          timeoutMs: 15000\n        });\n        if (!res.ok) throw new Error(`HTTP ${res.status}`);\n        return res.json();\n      });\n      const m = (convo as any)?.messages ?? (convo as any)?.items;\n      return Array.isArray(m) ? m : null;\n    } catch {\n      return null;\n    }\n  }\n}\n","import type { ChatRequest, ChatStreamEvent } from \"./types\";\nimport { streamChat, retryChat, cancelChat } from \"./chatApi\";\n\nexport type StreamCallbacks = {\n  onEvent: (ev: ChatStreamEvent) => void;\n  onClosed: () => void;\n};\n\nexport class ChatController {\n  private aborter: AbortController | null = null;\n  private lastRequest: ChatRequest | null = null;\n  private lastRunId: string | null = null;\n  private lastConversationId: string | null = null;\n  private lastMessageId: string | null = null;  // For /v1/chat/retry\n\n  isStreaming(): boolean {\n    return this.aborter !== null;\n  }\n\n  cancel(): void {\n    // Abort the SSE stream immediately for fast UX\n    this.aborter?.abort();\n    this.aborter = null;\n    \n    // Fire cancel API best-effort for resource control\n    if (this.lastRunId) {\n      cancelChat(this.lastRunId).catch(err => {\n        console.warn(\"Cancel request failed:\", err);\n      });\n      this.lastRunId = null;\n    }\n  }\n\n  async send(req: ChatRequest, cb: StreamCallbacks): Promise<void> {\n    this.cancel();\n    this.lastRequest = structuredClone(req);\n    this.lastConversationId = req.conversation_id ?? null;\n    this.lastRunId = null;\n    this.lastMessageId = null;\n\n    const aborter = new AbortController();\n    this.aborter = aborter;\n\n    try {\n      // Start streaming - run_id is yielded as first meta event from POST response\n      for await (const ev of streamChat(req, aborter.signal)) {\n        // Capture run_id from meta event (comes from POST /v1/chat response)\n        if (ev.type === \"meta\" && ev.run_id && !this.lastRunId) {\n          this.lastRunId = ev.run_id;\n        }\n        cb.onEvent(ev);\n        if (ev.type === \"done\" || ev.type === \"error\") {\n          // keep reading until done; but UI can mark error immediately\n        }\n      }\n    } catch (e: any) {\n      if (e?.name === \"AbortError\") {\n        cb.onEvent({ type: \"stopped\" });\n      } else {\n        cb.onEvent({ type: \"error\", message: String(e?.message ?? e) });\n      }\n    } finally {\n      this.aborter = null;\n      cb.onClosed();\n    }\n  }\n\n  async retry(conversationId: string, messageId: string, cb: StreamCallbacks): Promise<void> {\n    if (!conversationId || !messageId) {\n      cb.onEvent({ type: \"error\", message: \"Missing conversation_id or message_id for retry\" });\n      cb.onClosed();\n      return;\n    }\n\n    this.cancel();\n    this.lastConversationId = conversationId;\n    this.lastMessageId = messageId;\n    this.lastRunId = null;\n\n    const aborter = new AbortController();\n    this.aborter = aborter;\n\n    try {\n      // Use /v1/chat/retry endpoint for proper retry semantics\n      for await (const ev of retryChat(conversationId, messageId, aborter.signal)) {\n        // Capture run_id from meta event (comes from POST /v1/chat/retry response)\n        if (ev.type === \"meta\" && ev.run_id && !this.lastRunId) {\n          this.lastRunId = ev.run_id;\n        }\n        cb.onEvent(ev);\n        if (ev.type === \"done\" || ev.type === \"error\") {\n          // keep reading until done\n        }\n      }\n    } catch (e: any) {\n      if (e?.name === \"AbortError\") {\n        cb.onEvent({ type: \"stopped\" });\n      } else {\n        cb.onEvent({ type: \"error\", message: String(e?.message ?? e) });\n      }\n    } finally {\n      this.aborter = null;\n      cb.onClosed();\n    }\n  }\n}\n","import { createStore } from \"../state/store\";\nimport type { ChatMessage } from \"./types\";\n\nexport type ThreadChatState = {\n  threadId: string; // \"new\" allowed until backend returns a real id\n  messages: ChatMessage[];\n  streaming: boolean;\n  lastError?: string;\n};\n\ntype ChatState = {\n  byThread: Record<string, ThreadChatState>;\n};\n\nexport const chatStore = createStore<ChatState>({\n  byThread: {}\n});\n\nexport function getThreadState(threadId: string): ThreadChatState {\n  const s = chatStore.get().byThread[threadId];\n  if (s) return s;\n  const init: ThreadChatState = { threadId, messages: [], streaming: false };\n  chatStore.patch({ byThread: { ...chatStore.get().byThread, [threadId]: init } });\n  return init;\n}\n\nexport function setThreadStreaming(threadId: string, streaming: boolean) {\n  const s = getThreadState(threadId);\n  const next = { ...s, streaming, lastError: undefined };\n  chatStore.patch({ byThread: { ...chatStore.get().byThread, [threadId]: next } });\n}\n\nexport function setThreadError(threadId: string, msg?: string) {\n  const s = getThreadState(threadId);\n  const next = { ...s, streaming: false, lastError: msg };\n  chatStore.patch({ byThread: { ...chatStore.get().byThread, [threadId]: next } });\n}\n\nexport function upsertMessages(threadId: string, messages: ChatMessage[]) {\n  const s = getThreadState(threadId);\n  const next = { ...s, messages };\n  chatStore.patch({ byThread: { ...chatStore.get().byThread, [threadId]: next } });\n}\n\nexport function appendMessage(threadId: string, m: ChatMessage) {\n  const s = getThreadState(threadId);\n  upsertMessages(threadId, [...s.messages, m]);\n}\n\nexport function patchMessage(threadId: string, id: string, patch: Partial<ChatMessage>) {\n  const s = getThreadState(threadId);\n  upsertMessages(\n    threadId,\n    s.messages.map((x) => (x.id === id ? { ...x, ...patch } : x))\n  );\n}\n\nexport function migrateThread(oldId: string, newId: string) {\n  const state = chatStore.get();\n  const old = state.byThread[oldId];\n  if (!old) return;\n  const byThread = { ...state.byThread };\n  delete byThread[oldId];\n  byThread[newId] = { ...old, threadId: newId };\n  chatStore.patch({ byThread });\n}\n","export function MemoryPanel(props: { conversationId: string | null }) {\n  return (\n    <div class=\"panelCard\">\n      <div class=\"panelHeader\">\n        <div class=\"panelTitle\">Memory</div>\n        <div class=\"muted panelSub\">Feature-flagged shell (no API wiring yet)</div>\n      </div>\n\n      <div class=\"panelSection\">\n        <div class=\"muted\">Conversation:</div>\n        <div class=\"mono\">{props.conversationId ?? \"(new)\"}</div>\n      </div>\n\n      <div class=\"panelSection\">\n        <div class=\"muted\">\n          Planned v1 wiring:\n          <ul>\n            <li>List saved memories</li>\n            <li>Pin/save from messages</li>\n            <li>Search/filter</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n","export function KnowledgePanel() {\n  return (\n    <div class=\"panelCard\">\n      <div class=\"panelHeader\">\n        <div class=\"panelTitle\">Knowledge</div>\n        <div class=\"muted panelSub\">Feature-flagged shell (no API wiring yet)</div>\n      </div>\n\n      <div class=\"panelSection\">\n        <div class=\"muted\">\n          Planned v1 wiring:\n          <ul>\n            <li>Browse/search indexed sources</li>\n            <li>Attach sources to a chat run</li>\n            <li>Show citations per message</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n","export function VoicePanel() {\n  return (\n    <div class=\"panelCard\">\n      <div class=\"panelHeader\">\n        <div class=\"panelTitle\">Voice</div>\n        <div class=\"muted panelSub\">Feature-flagged shell (no mic/TTS wiring yet)</div>\n      </div>\n\n      <div class=\"panelSection\">\n        <div class=\"row\">\n          <button class=\"btn\" disabled aria-disabled=\"true\">Record</button>\n          <button class=\"btn\" disabled aria-disabled=\"true\">Stop</button>\n          <button class=\"btn\" disabled aria-disabled=\"true\">Play TTS</button>\n        </div>\n        <div class=\"muted\" style=\"font-size:12px;margin-top:10px;\">\n          Future: record → upload to backend Voice agent → transcript in chat composer; optional TTS playback.\n        </div>\n      </div>\n    </div>\n  );\n}\n","export function ToolsPanel() {\n  return (\n    <div class=\"panelCard\">\n      <div class=\"panelHeader\">\n        <div class=\"panelTitle\">Tools</div>\n        <div class=\"muted panelSub\">Feature-flagged shell (no tool execution wiring yet)</div>\n      </div>\n\n      <div class=\"panelSection\">\n        <label class=\"checkRow\">\n          <input type=\"checkbox\" disabled aria-disabled=\"true\" />\n          <span>Enable tool calls</span>\n        </label>\n        <label class=\"checkRow\">\n          <input type=\"checkbox\" disabled aria-disabled=\"true\" />\n          <span>Show tool I/O in transcript</span>\n        </label>\n        <label class=\"checkRow\">\n          <input type=\"checkbox\" disabled aria-disabled=\"true\" />\n          <span>Require confirmation before tool use</span>\n        </label>\n\n        <div class=\"muted\" style=\"font-size:12px;margin-top:10px;\">\n          Future: toggle affects chat request payload (tools) sent to backend Tool agent.\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { getFlags } from \"../core/config/featureFlags\";\nimport { setPrefs, uiPrefsStore } from \"../core/prefs/uiPrefsStore\";\nimport { useEffect, useMemo, useState } from \"preact/hooks\";\n\nimport { MemoryPanel } from \"./panels/MemoryPanel\";\nimport { KnowledgePanel } from \"./panels/KnowledgePanel\";\nimport { VoicePanel } from \"./panels/VoicePanel\";\nimport { ToolsPanel } from \"./panels/ToolsPanel\";\n\ntype PanelKey = \"memory\" | \"knowledge\" | \"voice\" | \"tools\";\n\nfunction useStore<T>(store: { get: () => T; subscribe: (fn: () => void) => () => void }) {\n  const [v, setV] = useState(store.get());\n  useEffect(() => store.subscribe(() => setV(store.get())), []);\n  return v;\n}\n\nfunction enabledPanels(): Array<{ key: PanelKey; label: string }> {\n  const f = getFlags();\n  const out: Array<{ key: PanelKey; label: string }> = [];\n  if (f.memoryPanel) out.push({ key: \"memory\", label: \"Memory\" });\n  if (f.knowledgePanel) out.push({ key: \"knowledge\", label: \"Knowledge\" });\n  if (f.voice) out.push({ key: \"voice\", label: \"Voice\" });\n  if (f.tools) out.push({ key: \"tools\", label: \"Tools\" });\n  return out;\n}\n\nexport function PanelDock(props: { conversationId?: string | null }) {\n  const prefs = useStore(uiPrefsStore);\n  const panels = useMemo(() => enabledPanels(), []);\n\n  // If no panels enabled, render nothing.\n  if (!panels.length) return null;\n  if (!prefs.panelDockOpen) return null;\n\n  const active = panels.some((p) => p.key === prefs.activePanel)\n    ? prefs.activePanel\n    : panels[0]!.key;\n\n  function close() {\n    setPrefs({ panelDockOpen: false });\n  }\n\n  return (\n    <aside class=\"panelDock\" aria-label=\"Side panels\">\n      <div class=\"panelDockTop\">\n        <div class=\"panelDockTitle\">Panels</div>\n        <button class=\"btn\" onClick={close} aria-label=\"Close panels\">Close</button>\n      </div>\n\n      <div class=\"panelTabs\" role=\"tablist\" aria-label=\"Panels\">\n        {panels.map((p) => {\n          const selected = p.key === active;\n          return (\n            <button\n              class={`tab ${selected ? \"active\" : \"\"}`}\n              role=\"tab\"\n              aria-selected={selected}\n              onClick={() => setPrefs({ activePanel: p.key })}\n            >\n              {p.label}\n            </button>\n          );\n        })}\n      </div>\n\n      <div class=\"panelBody\" role=\"tabpanel\">\n        {active === \"memory\" ? <MemoryPanel conversationId={props.conversationId ?? null} /> : null}\n        {active === \"knowledge\" ? <KnowledgePanel /> : null}\n        {active === \"voice\" ? <VoicePanel /> : null}\n        {active === \"tools\" ? <ToolsPanel /> : null}\n      </div>\n    </aside>\n  );\n}\n","import { useEffect, useMemo, useState } from \"preact/hooks\";\nimport { Banner } from \"../components/Banner\";\nimport { MessageList } from \"../components/MessageList\";\nimport { ChatComposer } from \"../components/ChatComposer\";\nimport { ChatController } from \"../core/chat/chatController\";\nimport type { ChatMessage, ChatRequest, ChatStreamEvent } from \"../core/chat/types\";\nimport {\n  chatStore,\n  getThreadState,\n  setThreadStreaming,\n  setThreadError,\n  appendMessage,\n  patchMessage,\n  migrateThread\n} from \"../core/chat/chatStore\";\nimport { tryLoadMessages } from \"../core/chat/chatApi\";\nimport { navigate } from \"../core/router/hashRouter\";\nimport { uiPrefsStore, setPrefs } from \"../core/prefs/uiPrefsStore\";\nimport { getFlags } from \"../core/config/featureFlags\";\nimport { PanelDock } from \"../components/PanelDock\";\n\n// If you already have a uuid helper from earlier phases, use it instead.\nfunction uuidv4(): string {\n  const c = globalThis.crypto as any;\n  if (c?.randomUUID) return c.randomUUID();\n  const bytes = new Uint8Array(16);\n  if (c?.getRandomValues) {\n    c.getRandomValues(bytes);\n  } else {\n    for (let i = 0; i < bytes.length; i += 1) {\n      bytes[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  bytes[6] = ((bytes[6] ?? 0) & 0x0f) | 0x40;\n  bytes[8] = ((bytes[8] ?? 0) & 0x3f) | 0x80;\n  const hex = [...bytes].map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n  return `${hex.slice(0,8)}-${hex.slice(8,12)}-${hex.slice(12,16)}-${hex.slice(16,20)}-${hex.slice(20)}`;\n}\n\nfunction normalizeHistory(raw: any[]): ChatMessage[] {\n  // Best-effort mapping.\n  return raw\n    .map((x: any) => ({\n      id: String(x?.id ?? uuidv4()),\n      role: (x?.role ?? x?.author ?? \"assistant\") as any,\n      content: String(x?.content ?? x?.text ?? \"\"),\n      createdAt: Number(x?.createdAt ?? x?.created_at ?? Date.now()),\n      status: \"done\" as const\n    }))\n    .filter((m) => m.content.length > 0);\n}\n\nexport function ChatRoute(props: { threadId?: string }) {\n  const ctrl = useMemo(() => new ChatController(), []);\n  const threadId = props.threadId ?? \"new\";\n\n  const [state, setState] = useState(getThreadState(threadId));\n  useEffect(() => chatStore.subscribe(() => setState(getThreadState(threadId))), [threadId]);\n\n  const [prefs, setLocalPrefs] = useState(uiPrefsStore.get());\n  useEffect(() => uiPrefsStore.subscribe(() => setLocalPrefs(uiPrefsStore.get())), []);\n\n  const flags = getFlags();\n  const anyPanels = flags.memoryPanel || flags.knowledgePanel || flags.voice || flags.tools;\n\n  // Load history best-effort when navigating to an existing thread.\n  useEffect(() => {\n    const existingThreadId = props.threadId;\n    if (!existingThreadId) return;\n    (async () => {\n      const raw = await tryLoadMessages(existingThreadId);\n      if (raw) {\n        const msgs = normalizeHistory(raw);\n        // Replace only if store currently empty (avoid clobbering fresh local state).\n        if (getThreadState(existingThreadId).messages.length === 0) {\n          // direct set via helper\n          const s = getThreadState(existingThreadId);\n          // reuse store helper\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          const _ = s;\n          // minimal:\n          chatStore.patch({\n            byThread: {\n              ...chatStore.get().byThread,\n              [existingThreadId]: { ...getThreadState(existingThreadId), messages: msgs }\n            }\n          });\n        }\n      }\n    })().catch(() => {});\n  }, [props.threadId]);\n\n  async function onSend(text: string) {\n    const userId = uuidv4();\n    const asstId = uuidv4();\n\n    appendMessage(threadId, {\n      id: userId,\n      role: \"user\",\n      content: text,\n      createdAt: Date.now(),\n      status: \"done\"\n    });\n\n    appendMessage(threadId, {\n      id: asstId,\n      role: \"assistant\",\n      content: \"\",\n      createdAt: Date.now(),\n      status: \"streaming\"\n    });\n\n    setThreadStreaming(threadId, true);\n\n    const req: ChatRequest = {\n      conversation_id: props.threadId, // undefined if new\n      input: text,\n      client_request_id: uuidv4(),\n\n      // Phase 4: include provider/model/settings\n      provider: prefs.providerId ?? undefined,\n      model: prefs.modelId ?? undefined,\n      settings: {\n        temperature: prefs.temperature,\n        top_p: prefs.topP,\n        max_tokens: prefs.maxTokens\n      }\n    };\n\n    await ctrl.send(req, {\n      onEvent: (ev: ChatStreamEvent) => {\n        if (ev.type === \"meta\" && ev.conversation_id && !props.threadId) {\n          // Backend created a thread; migrate local \"new\" state and navigate.\n          migrateThread(\"new\", ev.conversation_id);\n          navigate(`/chat/${ev.conversation_id}`);\n          return;\n        }\n\n        if (ev.type === \"delta\") {\n          // Delta: append to assistant bubble\n          const cur = getThreadState(threadId).messages.find((m) => m.id === asstId);\n          patchMessage(threadId, asstId, { content: (cur?.content ?? \"\") + ev.text, status: \"streaming\" });\n          return;\n        }\n\n        if (ev.type === \"full\") {\n          // Full message: replace content (not append) - marks end of assistant response\n          patchMessage(threadId, asstId, { content: ev.content, status: \"streaming\" });\n          return;\n        }\n\n        if (ev.type === \"error\") {\n          patchMessage(threadId, asstId, { status: \"error\", content: `Error: ${ev.message}` });\n          setThreadError(threadId, ev.message);\n          return;\n        }\n\n        if (ev.type === \"stopped\") {\n          // Stopped: user cancelled, distinct from error\n          patchMessage(threadId, asstId, { status: \"stopped\" });\n          setThreadError(threadId);\n          return;\n        }\n\n        if (ev.type === \"done\") {\n          patchMessage(threadId, asstId, { status: \"done\" });\n          setThreadStreaming(threadId, false);\n          return;\n        }\n      },\n      onClosed: () => {\n        setThreadStreaming(threadId, false);\n      }\n    });\n  }\n\n  function onStop() {\n    ctrl.cancel();\n    setThreadStreaming(threadId, false);\n  }\n\n  async function onRetry() {\n    // Reuse the most recent assistant error/stopped bubble if present.\n    const msgs = getThreadState(threadId).messages;\n    const lastAsst = [...msgs].reverse().find((m) => m.role === \"assistant\");\n    if (!lastAsst) return;\n\n    // Get conversation ID from props or state\n    const convId = props.threadId || threadId;\n    if (!convId || convId === \"new\") {\n      // Can't retry without a conversation\n      return;\n    }\n\n    patchMessage(threadId, lastAsst.id, { content: \"\", status: \"streaming\" });\n    setThreadStreaming(threadId, true);\n\n    // Call retry with conversation_id and message_id for /v1/chat/retry\n    await ctrl.retry(convId, lastAsst.id, {\n      onEvent: (ev) => {\n        if (ev.type === \"delta\") {\n          const cur = getThreadState(threadId).messages.find((m) => m.id === lastAsst.id);\n          patchMessage(threadId, lastAsst.id, { content: (cur?.content ?? \"\") + ev.text, status: \"streaming\" });\n        } else if (ev.type === \"error\") {\n          if (ev.message === \"stopped\") {\n            patchMessage(threadId, lastAsst.id, { status: \"stopped\" });\n            setThreadError(threadId);\n          } else {\n            patchMessage(threadId, lastAsst.id, { status: \"error\", content: `Error: ${ev.message}` });\n            setThreadError(threadId, ev.message);\n          }\n        } else if (ev.type === \"done\") {\n          patchMessage(threadId, lastAsst.id, { status: \"done\" });\n          setThreadStreaming(threadId, false);\n        }\n      },\n      onClosed: () => setThreadStreaming(threadId, false)\n    });\n  }\n\n  return (\n    <div class={`chatShell ${prefs.panelDockOpen && anyPanels ? \"withDock\" : \"\"}`}>\n      {state.lastError ? <Banner kind=\"error\" text={state.lastError} /> : null}\n\n      {anyPanels ? (\n        <div class=\"chatTopRow\">\n          <button\n            class=\"btn\"\n            onClick={() => setPrefs({ panelDockOpen: !prefs.panelDockOpen })}\n            aria-label=\"Toggle panels\"\n          >\n            {prefs.panelDockOpen ? \"Hide panels\" : \"Show panels\"}\n          </button>\n        </div>\n      ) : null}\n\n      <MessageList messages={state.messages} />\n      <ChatComposer streaming={state.streaming} onSend={onSend} onStop={onStop} onRetry={onRetry} />\n\n      {anyPanels ? <PanelDock conversationId={props.threadId ?? null} /> : null}\n    </div>\n  );\n}\n","import { ModelSettingsForm } from \"../components/ModelSettingsForm\";\n\nexport function SettingsRoute() {\n  return (\n    <div class=\"page pad\">\n      <div class=\"card wide\">\n        <h1 class=\"h1\">Settings</h1>\n        <p class=\"muted\">Provider/model selection and chat defaults (stored locally).</p>\n        <ModelSettingsForm />\n      </div>\n    </div>\n  );\n}\n","export function AdminRoute() {\n  return (\n    <div class=\"page pad\">\n      <div class=\"card wide\">\n        <h1 class=\"h1\">Admin</h1>\n        <p class=\"muted\">Phase 4/5 will role-gate this route via backend meta/auth.</p>\n      </div>\n    </div>\n  );\n}\n","import { ensureCsrfToken, getCsrfToken } from \"./csrf\";\nimport { endpoints } from \"./endpoints\";\nimport { ApiError, type ApiErrorCode } from \"./errors\";\nimport { fetchWithTimeout, readErrorBody, tryPaths } from \"./http\";\n\nexport type DuckDnsStatus = {\n  token_present: boolean;\n  subdomain: string;\n  scheduler_enabled: boolean;\n  scheduler_interval_minutes: number;\n  scheduler_last_run_unix: number | null;\n  scheduler_stale: boolean;\n  scheduler_stale_threshold_minutes: number;\n  next_scheduled_run_unix: number | null;\n  last_update: null | {\n    id: string;\n    created_at: string | null;\n    ip: string | null;\n    response: string | null;\n    success: boolean;\n    error_code: string | null;\n    error_message: string | null;\n    latency_ms: number | null;\n    source: string;\n  };\n};\n\nexport type DuckDnsLog = {\n  id: string;\n  created_at: string | null;\n  subdomain: string;\n  ip: string | null;\n  response: string | null;\n  success: boolean;\n  error_code: string | null;\n  error_message: string | null;\n  latency_ms: number | null;\n  actor_user_id: string | null;\n  source: string;\n};\n\nasync function parseOrThrow(res: Response): Promise<any> {\n  if (!res.ok) {\n    const bodyText = await readErrorBody(res);\n    let code: ApiErrorCode = \"server_error\";\n    let message = `Request failed (${res.status})`;\n    try {\n      const payload = JSON.parse(bodyText);\n      if (typeof payload?.error?.code === \"string\") {\n        const raw = String(payload.error.code).toLowerCase();\n        if (raw === \"unauthorized\") code = \"unauthorized\";\n        else if (raw === \"forbidden\") code = \"forbidden\";\n        else if (raw === \"csrf_failed\") code = \"csrf_failed\";\n        else if (raw === \"rate_limited\") code = \"rate_limited\";\n        else code = \"server_error\";\n      }\n      if (typeof payload?.error?.message === \"string\") message = payload.error.message;\n    } catch {\n      // ignore non-JSON bodies\n    }\n    throw new ApiError(code, message, res.status, bodyText);\n  }\n  return await res.json();\n}\n\nexport async function getDuckDnsStatus(): Promise<DuckDnsStatus> {\n  return tryPaths(endpoints.opsDuckdnsStatus, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { Accept: \"application/json\" },\n      timeoutMs: 15000\n    });\n    return parseOrThrow(res);\n  });\n}\n\nexport async function getDuckDnsLogs(limit = 200): Promise<DuckDnsLog[]> {\n  return tryPaths(endpoints.opsDuckdnsLogs, async (base) => {\n    const url = `${base}?limit=${encodeURIComponent(String(limit))}`;\n    const res = await fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { Accept: \"application/json\" },\n      timeoutMs: 15000\n    });\n    const payload = await parseOrThrow(res);\n    return Array.isArray(payload?.logs) ? payload.logs : [];\n  });\n}\n\nexport async function postDuckDnsUpdate(force: boolean): Promise<any> {\n  await ensureCsrfToken();\n  return tryPaths(endpoints.opsDuckdnsUpdate, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({ force }),\n      timeoutMs: 30000\n    });\n    return parseOrThrow(res);\n  });\n}\n\nexport async function postDuckDnsTest(ip?: string): Promise<any> {\n  await ensureCsrfToken();\n  return tryPaths(endpoints.opsDuckdnsTest, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify(ip ? { ip } : {}),\n      timeoutMs: 30000\n    });\n    return parseOrThrow(res);\n  });\n}\n","import { useEffect, useMemo, useState } from \"preact/hooks\";\nimport {\n  getDuckDnsLogs,\n  getDuckDnsStatus,\n  postDuckDnsTest,\n  postDuckDnsUpdate,\n  type DuckDnsLog,\n  type DuckDnsStatus\n} from \"../core/api/opsDuckdnsApi\";\n\nfunction remediationFor(code?: string | null): string {\n  switch ((code || \"\").toUpperCase()) {\n    case \"DUCKDNS_TOKEN_MISSING\":\n      return \"Set DUCKDNS_TOKEN on server (Machine scope), then restart backend/scheduler.\";\n    case \"DUCKDNS_KO\":\n      return \"DuckDNS rejected token/subdomain pair. Verify both values in DuckDNS dashboard.\";\n    case \"DUCKDNS_NETWORK\":\n      return \"Server cannot reach DuckDNS/IP services. Check DNS, firewall, and outbound connectivity.\";\n    case \"DUCKDNS_PARSE\":\n      return \"Unexpected provider response. Check logs and try manual update again.\";\n    default:\n      return \"Check latest logs and backend health endpoint for more context.\";\n  }\n}\n\nfunction fmtUnix(value: number | null | undefined): string {\n  if (!value) return \"n/a\";\n  return new Date(value * 1000).toLocaleString();\n}\n\nfunction fmtIso(value: string | null | undefined): string {\n  if (!value) return \"n/a\";\n  return new Date(value).toLocaleString();\n}\n\nexport function OpsRoute() {\n  const [status, setStatus] = useState<DuckDnsStatus | null>(null);\n  const [logs, setLogs] = useState<DuckDnsLog[]>([]);\n  const [busy, setBusy] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [actionNote, setActionNote] = useState<string | null>(null);\n\n  async function loadData() {\n    try {\n      setError(null);\n      const [s, l] = await Promise.all([getDuckDnsStatus(), getDuckDnsLogs(200)]);\n      setStatus(s);\n      setLogs(l);\n    } catch (e: any) {\n      setError(String(e?.message || e));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    void loadData();\n  }, []);\n\n  useEffect(() => {\n    if (!autoRefresh) return;\n    const t = window.setInterval(() => void loadData(), 10000);\n    return () => window.clearInterval(t);\n  }, [autoRefresh]);\n\n  async function onTest() {\n    setBusy(true);\n    setActionNote(null);\n    try {\n      const res = await postDuckDnsTest();\n      setActionNote(`Test executed: ${res?.response ?? \"OK\"} (${res?.ip ?? \"no ip\"})`);\n      await loadData();\n    } catch (e: any) {\n      setActionNote(`Test failed: ${String(e?.message || e)}`);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function onForceUpdate() {\n    setBusy(true);\n    setActionNote(null);\n    try {\n      const res = await postDuckDnsUpdate(true);\n      setActionNote(`Force update executed: ${res?.response ?? \"OK\"} (${res?.ip ?? \"no ip\"})`);\n      await loadData();\n    } catch (e: any) {\n      setActionNote(`Force update failed: ${String(e?.message || e)}`);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function onCopyDiagnostics() {\n    const bundle = {\n      generated_at: new Date().toISOString(),\n      status,\n      recent_logs: logs.slice(0, 50).map((l) => ({\n        created_at: l.created_at,\n        subdomain: l.subdomain,\n        ip: l.ip,\n        response: l.response,\n        success: l.success,\n        error_code: l.error_code,\n        error_message: l.error_message,\n        latency_ms: l.latency_ms,\n        source: l.source\n      }))\n    };\n    await navigator.clipboard.writeText(JSON.stringify(bundle, null, 2));\n    setActionNote(\"Redacted diagnostics copied to clipboard.\");\n  }\n\n  const lastErrorCode = status?.last_update?.error_code ?? logs.find((x) => !x.success)?.error_code;\n  const remediation = useMemo(() => remediationFor(lastErrorCode), [lastErrorCode]);\n\n  return (\n    <div class=\"page pad\" data-testid=\"ops-page\">\n      <div class=\"card wide\">\n        <h1 class=\"h1\">Ops Console</h1>\n        <p class=\"muted\">Admin-only DuckDNS operations and diagnostics.</p>\n      </div>\n\n      {loading ? (\n        <div class=\"card wide\"><p role=\"status\">Loading DuckDNS status...</p></div>\n      ) : null}\n\n      {error ? (\n        <div class=\"card wide\" role=\"alert\" aria-live=\"assertive\">\n          <h2 class=\"h2\">Backend Unreachable</h2>\n          <p class=\"muted\">{error}</p>\n          <button class=\"btn\" onClick={() => void loadData()} aria-label=\"Retry loading ops status\">Retry</button>\n        </div>\n      ) : null}\n\n      {status ? (\n        <div class=\"card wide\" aria-label=\"DuckDNS status card\">\n          <h2 class=\"h2\">DuckDNS Status</h2>\n          {status.scheduler_enabled && status.scheduler_stale ? (\n            <p role=\"alert\" aria-live=\"assertive\" style=\"color:#b45309; font-weight:600;\">\n              Scheduler health warning: last run is older than {status.scheduler_stale_threshold_minutes} minutes.\n            </p>\n          ) : null}\n          <p><strong>Token present:</strong> {status.token_present ? \"Yes\" : \"No\"}</p>\n          <p><strong>Subdomain:</strong> {status.subdomain}</p>\n          <p><strong>Scheduler enabled:</strong> {status.scheduler_enabled ? \"Yes\" : \"No\"}</p>\n          <p><strong>Scheduler last run:</strong> {fmtUnix(status.scheduler_last_run_unix)}</p>\n          <p><strong>Scheduler stale:</strong> {status.scheduler_stale ? \"Yes\" : \"No\"}</p>\n          <p><strong>Last update:</strong> {fmtIso(status.last_update?.created_at)}</p>\n          <p><strong>Last IP:</strong> {status.last_update?.ip || \"n/a\"}</p>\n          <p><strong>Last response:</strong> {status.last_update?.response || \"n/a\"}</p>\n          <p><strong>Last error code:</strong> {status.last_update?.error_code || \"n/a\"}</p>\n          <p><strong>Last error message:</strong> {status.last_update?.error_message || \"n/a\"}</p>\n          <p><strong>Next scheduled run:</strong> {fmtUnix(status.next_scheduled_run_unix)}</p>\n        </div>\n      ) : null}\n\n      <div class=\"card wide\">\n        <h2 class=\"h2\">Actions</h2>\n        <div style=\"display:flex; gap:8px; flex-wrap:wrap;\">\n          <button class=\"btn primary\" onClick={() => void onTest()} disabled={busy} aria-label=\"Test DuckDNS now\">\n            Test DuckDNS now\n          </button>\n          <button class=\"btn\" onClick={() => void onForceUpdate()} disabled={busy} aria-label=\"Force DuckDNS update now\">\n            Force update now\n          </button>\n          <button class=\"btn\" onClick={() => void onCopyDiagnostics()} aria-label=\"Copy diagnostic bundle\">\n            Copy diagnostic bundle\n          </button>\n          <label style=\"display:flex; align-items:center; gap:6px;\">\n            <input\n              type=\"checkbox\"\n              checked={autoRefresh}\n              onChange={(e: any) => setAutoRefresh(Boolean(e.currentTarget?.checked))}\n              aria-label=\"Toggle auto refresh\"\n            />\n            Auto-refresh\n          </label>\n        </div>\n        {actionNote ? <p role=\"status\">{actionNote}</p> : null}\n      </div>\n\n      <div class=\"card wide\" role=\"region\" aria-label=\"Remediation guidance\">\n        <h2 class=\"h2\">Remediation</h2>\n        <p><strong>Error code:</strong> {lastErrorCode || \"n/a\"}</p>\n        <p>{remediation}</p>\n      </div>\n\n      <div class=\"card wide\">\n        <h2 class=\"h2\">Recent DuckDNS Logs</h2>\n        <div style=\"max-height: 360px; overflow: auto;\">\n          <table style=\"width:100%; border-collapse: collapse;\" aria-label=\"DuckDNS recent logs table\">\n            <thead>\n              <tr>\n                <th align=\"left\">Time</th>\n                <th align=\"left\">Source</th>\n                <th align=\"left\">IP</th>\n                <th align=\"left\">Response</th>\n                <th align=\"left\">Error</th>\n              </tr>\n            </thead>\n            <tbody>\n              {logs.map((row) => (\n                <tr key={row.id}>\n                  <td>{fmtIso(row.created_at)}</td>\n                  <td>{row.source}</td>\n                  <td>{row.ip || \"n/a\"}</td>\n                  <td>{row.response || \"n/a\"}</td>\n                  <td>{row.error_code || \"-\"}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n          {logs.length === 0 ? <p class=\"muted\">No logs yet.</p> : null}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { endpoints, conversationEndpoint, conversationMessagesEndpoint } from \"../api/endpoints\";\nimport { ApiError } from \"../api/errors\";\nimport { ensureCsrfToken, getCsrfToken } from \"../api/csrf\";\nimport { classifyHttpError, fetchWithTimeout, readErrorBody, tryPaths } from \"../api/http\";\n\nexport interface Conversation {\n  id: string;\n  title: string;\n  provider?: string;\n  model?: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface Message {\n  id: string;\n  role: string;\n  content: string;\n  provider?: string;\n  model?: string;\n  tokens_prompt?: number;\n  tokens_completion?: number;\n  created_at: string;\n}\n\nexport async function listConversations(limit = 50, offset = 0): Promise<Conversation[]> {\n  return tryPaths(endpoints.conversations, async (url) => {\n    const res = await fetchWithTimeout(`${url}?limit=${limit}&offset=${offset}`, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { \"Accept\": \"application/json\" },\n      timeoutMs: 15000\n    });\n\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `List conversations failed (${res.status})`, res.status, body)\n        : new ApiError(\"unknown\", `List conversations failed (${res.status})`, res.status, body);\n    }\n\n    return await res.json();\n  });\n}\n\nexport async function createConversation(title = \"New Conversation\"): Promise<Conversation> {\n  await ensureCsrfToken();\n\n  return tryPaths(endpoints.conversations, async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({ title }),\n      timeoutMs: 15000\n    });\n\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `Create conversation failed (${res.status})`, res.status, body)\n        : new ApiError(\"unknown\", `Create conversation failed (${res.status})`, res.status, body);\n    }\n\n    return await res.json();\n  });\n}\n\nexport async function renameConversation(id: string, title: string): Promise<Conversation> {\n  await ensureCsrfToken();\n\n  return tryPaths(conversationEndpoint(id), async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"PATCH\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      body: JSON.stringify({ title }),\n      timeoutMs: 15000\n    });\n\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `Rename conversation failed (${res.status})`, res.status, body)\n        : new ApiError(\"unknown\", `Rename conversation failed (${res.status})`, res.status, body);\n    }\n\n    return await res.json();\n  });\n}\n\nexport async function deleteConversation(id: string): Promise<void> {\n  await ensureCsrfToken();\n\n  return tryPaths(conversationEndpoint(id), async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"DELETE\",\n      credentials: \"include\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"X-CSRF-Token\": getCsrfToken() ?? \"\"\n      },\n      timeoutMs: 15000\n    });\n\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `Delete conversation failed (${res.status})`, res.status, body)\n        : new ApiError(\"unknown\", `Delete conversation failed (${res.status})`, res.status, body);\n    }\n  });\n}\n\nexport async function getMessages(conversationId: string): Promise<Message[]> {\n  return tryPaths(conversationMessagesEndpoint(conversationId), async (url) => {\n    const res = await fetchWithTimeout(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: { \"Accept\": \"application/json\" },\n      timeoutMs: 15000\n    });\n\n    if (!res.ok) {\n      const body = await readErrorBody(res);\n      throw classifyHttpError(res) instanceof ApiError\n        ? new ApiError(classifyHttpError(res).code, `Get messages failed (${res.status})`, res.status, body)\n        : new ApiError(\"unknown\", `Get messages failed (${res.status})`, res.status, body);\n    }\n\n    return await res.json();\n  });\n}\n","import { createStore } from \"../state/store\";\nimport * as conversationApi from \"./conversationApi\";\n\nexport type ConversationState = {\n  conversations: conversationApi.Conversation[];\n  currentId: string | null;\n  loading: boolean;\n  error?: string;\n};\n\nexport const conversationStore = createStore<ConversationState>({\n  conversations: [],\n  currentId: null,\n  loading: false\n});\n\nexport function setCurrentConversation(id: string | null) {\n  conversationStore.patch({ currentId: id });\n}\n\nexport async function loadConversations(): Promise<void> {\n  conversationStore.patch({ loading: true, error: undefined });\n\n  try {\n    const conversations = await conversationApi.listConversations();\n    conversationStore.patch({ conversations, loading: false });\n  } catch (e: any) {\n    conversationStore.patch({\n      loading: false,\n      error: String(e?.message ?? e)\n    });\n  }\n}\n\nexport async function createNewConversation(title?: string): Promise<conversationApi.Conversation> {\n  conversationStore.patch({ loading: true, error: undefined });\n\n  try {\n    const conversation = await conversationApi.createConversation(title);\n    conversationStore.patch({\n      conversations: [conversation, ...conversationStore.get().conversations],\n      currentId: conversation.id,\n      loading: false\n    });\n    return conversation;\n  } catch (e: any) {\n    conversationStore.patch({\n      loading: false,\n      error: String(e?.message ?? e)\n    });\n    throw e;\n  }\n}\n\nexport async function renameCurrentConversation(title: string): Promise<void> {\n  const { currentId, conversations } = conversationStore.get();\n  if (!currentId) return;\n\n  conversationStore.patch({ loading: true, error: undefined });\n\n  try {\n    const updated = await conversationApi.renameConversation(currentId, title);\n    conversationStore.patch({\n      conversations: conversations.map(c => c.id === currentId ? updated : c),\n      loading: false\n    });\n  } catch (e: any) {\n    conversationStore.patch({\n      loading: false,\n      error: String(e?.message ?? e)\n    });\n    throw e;\n  }\n}\n\nexport async function deleteConversationById(id: string): Promise<void> {\n  conversationStore.patch({ loading: true, error: undefined });\n\n  try {\n    await conversationApi.deleteConversation(id);\n    const { currentId, conversations } = conversationStore.get();\n    const newConversations = conversations.filter(c => c.id !== id);\n    conversationStore.patch({\n      conversations: newConversations,\n      currentId: currentId === id ? null : currentId,\n      loading: false\n    });\n  } catch (e: any) {\n    conversationStore.patch({\n      loading: false,\n      error: String(e?.message ?? e)\n    });\n    throw e;\n  }\n}\n\nexport async function deleteCurrentConversation(): Promise<void> {\n  const { currentId } = conversationStore.get();\n  if (!currentId) return;\n  await deleteConversationById(currentId);\n}\n","import { useEffect, useState } from \"preact/hooks\";\nimport { navigate } from \"../core/router/hashRouter\";\nimport * as conversationApi from \"../core/conversation/conversationApi\";\nimport {\n  conversationStore,\n  loadConversations,\n  createNewConversation,\n  renameCurrentConversation,\n  setCurrentConversation\n} from \"../core/conversation/conversationStore\";\n\nexport function ConversationSidebar() {\n  const [store, setStore] = useState(conversationStore.get());\n  const [search, setSearch] = useState(\"\");\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [editTitle, setEditTitle] = useState(\"\");\n  const [creating, setCreating] = useState(false);\n\n  useEffect(() => {\n    const unsub = conversationStore.subscribe(() => {\n      setStore(conversationStore.get());\n    });\n    return unsub;\n  }, []);\n\n  useEffect(() => {\n    void loadConversations();\n  }, []);\n\n  const filtered = store.conversations.filter(c =>\n    c.title.toLowerCase().includes(search.toLowerCase())\n  );\n\n  async function onNewChat() {\n    setCreating(true);\n    try {\n      const conv = await createNewConversation();\n      navigate(`/chat/${conv.id}`);\n    } catch (e) {\n      console.error(\"Failed to create conversation:\", e);\n    } finally {\n      setCreating(false);\n    }\n  }\n\n  async function onSelect(id: string) {\n    setCurrentConversation(id);\n    navigate(`/chat/${id}`);\n  }\n\n  function startEdit(e: Event, id: string, title: string) {\n    e.preventDefault();\n    e.stopPropagation();\n    setEditingId(id);\n    setEditTitle(title);\n  }\n\n  async function submitEdit(id: string) {\n    if (editTitle.trim()) {\n      try {\n        await renameCurrentConversation(editTitle.trim());\n      } catch (e) {\n        console.error(\"Failed to rename:\", e);\n      }\n    }\n    setEditingId(null);\n    setEditTitle(\"\");\n  }\n\n  async function onDelete(e: Event, id: string) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (confirm(\"Delete this conversation?\")) {\n      try {\n        await deleteConversationById(id);\n        if (store.currentId === id) {\n          navigate(\"/chat\");\n        }\n      } catch (e) {\n        console.error(\"Failed to delete:\", e);\n      }\n    }\n  }\n\n  async function deleteConversationById(id: string) {\n    await conversationApi.deleteConversation(id);\n    const { currentId, conversations } = conversationStore.get();\n    const newConversations = conversations.filter(c => c.id !== id);\n    conversationStore.patch({\n      conversations: newConversations,\n      currentId: currentId === id ? null : currentId,\n      loading: false\n    });\n  }\n\n  function formatDate(iso: string): string {\n    const d = new Date(iso);\n    const now = new Date();\n    const isToday = d.toDateString() === now.toDateString();\n    if (isToday) return d.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" });\n    return d.toLocaleDateString([], { month: \"short\", day: \"numeric\" });\n  }\n\n  return (\n    <div class=\"conversation-sidebar\">\n      <div class=\"sidebar-header\">\n        <button\n          class=\"btn new-chat-btn\"\n          onClick={onNewChat}\n          disabled={creating || store.loading}\n        >\n          {creating ? \"...\" : \"+ New chat\"}\n        </button>\n      </div>\n\n      <div class=\"sidebar-search\">\n        <input\n          class=\"input search-input\"\n          placeholder=\"Search conversations...\"\n          value={search}\n          onInput={(e) => setSearch((e.target as HTMLInputElement).value)}\n        />\n      </div>\n\n      <div class=\"conversation-list\">\n        {store.loading && store.conversations.length === 0 ? (\n          <div class=\"muted empty-state\">Loading...</div>\n        ) : filtered.length === 0 ? (\n          <div class=\"muted empty-state\">\n            {search ? \"No matching conversations\" : \"No conversations yet\"}\n          </div>\n        ) : (\n          filtered.map((conv) => (\n            <div\n              key={conv.id}\n              class={`conversation-item ${store.currentId === conv.id ? \"active\" : \"\"}`}\n              onClick={() => onSelect(conv.id)}\n            >\n              {editingId === conv.id ? (\n                <input\n                  class=\"input edit-input\"\n                  value={editTitle}\n                  autoFocus\n                  onInput={(e) => setEditTitle((e.target as HTMLInputElement).value)}\n                  onBlur={() => submitEdit(conv.id)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") submitEdit(conv.id);\n                    if (e.key === \"Escape\") {\n                      setEditingId(null);\n                      setEditTitle(\"\");\n                    }\n                  }}\n                  onClick={(e) => e.stopPropagation()}\n                />\n              ) : (\n                <>\n                  <div class=\"conversation-title\">{conv.title}</div>\n                  <div class=\"conversation-meta\">\n                    <span class=\"conversation-date\">{formatDate(conv.updated_at)}</span>\n                    <div class=\"conversation-actions\">\n                      <button\n                        class=\"action-btn\"\n                        title=\"Rename\"\n                        onClick={(e) => startEdit(e, conv.id, conv.title)}\n                      >\n                        ✎\n                      </button>\n                      <button\n                        class=\"action-btn delete\"\n                        title=\"Delete\"\n                        onClick={(e) => onDelete(e, conv.id)}\n                      >\n                        ×\n                      </button>\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          ))\n        )}\n      </div>\n\n      {store.error ? (\n        <div class=\"sidebar-error muted\">{store.error}</div>\n      ) : null}\n    </div>\n  );\n}\n","import { useEffect, useState } from \"preact/hooks\";\nimport type { RuntimeConfig } from \"./core/config/runtimeConfig\";\nimport { setRuntimeConfig } from \"./core/config/runtimeConfig\";\nimport { setFlagsFromRuntime } from \"./core/config/featureFlags\";\nimport { useHashLocation, Link } from \"./core/router/hashRouter\";\nimport { Layout } from \"./components/Layout\";\nimport { ErrorScreen } from \"./components/ErrorScreen\";\nimport { Banner } from \"./components/Banner\";\n\nimport { LoginRoute } from \"./routes/login\";\nimport { ChatRoute } from \"./routes/chat\";\nimport { SettingsRoute } from \"./routes/settings\";\nimport { AdminRoute } from \"./routes/admin\";\nimport { OpsRoute } from \"./routes/ops\";\n\nimport { authStore, hydrateAuth } from \"./core/auth/authStore\";\nimport { ConversationSidebar } from \"./components/ConversationSidebar\";\n\nfunction parseRoute(path: string): { name: string; threadId?: string } {\n  const clean = (path.split(\"?\")[0] ?? \"\").split(\"#\")[0] ?? \"\";\n  if (clean === \"/\" || clean === \"\") return { name: \"login\" };\n  if (clean === \"/login\") return { name: \"login\" };\n  if (clean === \"/settings\") return { name: \"settings\" };\n  if (clean === \"/admin\") return { name: \"admin\" };\n  if (clean === \"/ops\") return { name: \"ops\" };\n  if (clean.startsWith(\"/chat\")) {\n    const parts = clean.split(\"/\").filter(Boolean);\n    return { name: \"chat\", threadId: parts[1] };\n  }\n  return { name: \"login\" };\n}\n\nfunction routeRequiresAuth(name: string): boolean {\n  return name === \"chat\" || name === \"settings\" || name === \"admin\" || name === \"ops\";\n}\n\nexport function App(props: { runtimeConfig: RuntimeConfig }) {\n  setRuntimeConfig(props.runtimeConfig);\n  setFlagsFromRuntime(props.runtimeConfig);\n\n  const [path] = useHashLocation();\n  const r = parseRoute(path);\n\n  const [auth, setAuth] = useState(authStore.get());\n  useEffect(() => authStore.subscribe(() => setAuth(authStore.get())), []);\n\n  useEffect(() => {\n    void hydrateAuth();\n  }, []);\n\n  // Block on auth only for protected routes; allow login page to render while meta is pending.\n  if (routeRequiresAuth(r.name) && auth.status === \"unknown\") {\n    return (\n      <Layout\n        nav={\n          <div class=\"nav\">\n            <Link class=\"navItem\" to=\"/login\">Login</Link>\n          </div>\n        }\n      >\n        <div class=\"page pad\">\n          <div class=\"card wide\">\n            <h1 class=\"h1\">Loading session…</h1>\n            <p class=\"muted\">Checking authentication with backend.</p>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n\n  // Gate protected routes\n  if (routeRequiresAuth(r.name) && auth.status !== \"authenticated\") {\n    if (r.name !== \"login\") {\n      window.location.hash = \"#/login\";\n    }\n  }\n\n  // Role-gate admin/ops\n  const role = String(auth.role ?? \"\").toLowerCase();\n  const isAdmin = role === \"admin\" || role === \"owner\" || role === \"root\";\n\n  return (\n    <Layout\n      nav={\n        <div class=\"nav\">\n          <Link class=\"navItem\" to=\"/login\">Login</Link>\n          <Link class=\"navItem\" to=\"/chat\">Chat</Link>\n          <Link class=\"navItem\" to=\"/settings\">Settings</Link>\n          {isAdmin ? <Link class=\"navItem\" to=\"/admin\">Admin</Link> : null}\n          {isAdmin ? <Link class=\"navItem\" to=\"/ops\">Ops</Link> : null}\n        </div>\n      }\n      sidebar={\n        auth.status === \"authenticated\" ? <ConversationSidebar /> : undefined\n      }\n    >\n      {auth.lastError ? <Banner kind=\"error\" text={auth.lastError} /> : null}\n\n      {r.name === \"login\" && <LoginRoute />}\n      {r.name === \"chat\" && auth.status === \"authenticated\" && <ChatRoute threadId={r.threadId} />}\n      {r.name === \"settings\" && auth.status === \"authenticated\" && <SettingsRoute />}\n\n      {r.name === \"admin\" && auth.status === \"authenticated\" ? (\n        isAdmin ? <AdminRoute /> : <ErrorScreen title=\"Forbidden\" detail=\"Admin role required.\" />\n      ) : null}\n\n      {r.name === \"ops\" && auth.status === \"authenticated\" ? (\n        isAdmin ? <OpsRoute /> : <ErrorScreen title=\"Forbidden\" detail=\"Admin role required.\" />\n      ) : null}\n    </Layout>\n  );\n}\n","import { render } from \"preact\";\nimport { App } from \"./app\";\nimport { loadRuntimeConfig } from \"./core/config/runtimeConfig\";\nimport \"./styles/tokens.css\";\nimport \"./styles/base.css\";\n\nasync function bootstrap() {\n  const root = document.getElementById(\"app\");\n  if (!root) throw new Error(\"Missing #app\");\n\n  root.textContent = \"Loading…\";\n\n  const cfg = await loadRuntimeConfig();\n  render(<App runtimeConfig={cfg} />, root);\n}\n\nbootstrap().catch((err) => {\n  const root = document.getElementById(\"app\");\n  if (!root) return;\n  root.innerHTML = `\n    <div style=\"padding:16px;font-family:ui-sans-serif,system-ui;color:#e7eaf0;\">\n      <h1 style=\"margin:0 0 8px 0;font-size:18px;\">OmniAI failed to start</h1>\n      <pre style=\"white-space:pre-wrap;border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:12px;background:#101522;\">\n${String((err as any)?.message ?? err)}\n      </pre>\n      <button style=\"padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#6aa6ff;color:#07101f;font-weight:700;cursor:pointer\"\n              onclick=\"location.reload()\">Retry</button>\n    </div>\n  `;\n});\n"],"names":["n","l","u","i","o","r","e","f","c","s","a","p","v","y","d","w","g","_","t","m","k","x","S","C","M","$","O","N","I","h","b","P","B","A","L","D","T","j","F","H","E","V","z","q","G","_cfg","setRuntimeConfig","cfg","normalizeBaseUrl","getRuntimeConfig","trimmed","loadRuntimeConfig","url","res","DEFAULT_FLAGS","_flags","setFlagsFromRuntime","getFlags","getHashPath","raw","navigate","to","path","useHashLocation","setPath","useState","useEffect","onChange","Link","props","href","createStore","initial","value","subs","emit","fn","next","partial","endpoints","conversationEndpoint","id","ApiError","code","message","status","detail","fetchWithTimeout","init","timeoutMs","ctrl","signal","tryPaths","paths","BACKEND_BASE_URL","lastErr","readErrorBody","classifyHttpError","_csrfToken","getCsrfToken","clearCsrfToken","ensureCsrfToken","body","headerToken","text","json","getMeta","login","bodyText","logout","authStore","normalizeMeta","meta","authenticated","user","roleFromBool","role","hydrateAuth","authApi.getMeta","msg","isUnauthorized","doLogin","params","authApi.login","doLogout","authApi.logout","STORAGE_KEY","DEFAULTS","clamp","lo","hi","sanitize","load","parsed","save","uiPrefsStore","setPrefs","resetPrefs","normStr","fallback","normalizeModel","name","ctx","contextLength","normalizeProvider","modelsRaw","models","wrapFlatModels","listProviders","data","providersRaw","providers","modelData","providerStore","hydrateProviders","Banner","jsx","useStore","store","setV","findProvider","findModel","provider","ModelSettingsForm","prefs","provState","useMemo","model","providerValid","modelValid","jsxs","SettingsDrawer","Layout","auth","drawerOpen","setDrawerOpen","ErrorScreen","LoginRoute","username","setU","password","setP","invite","setI","busy","setBusy","err","setErr","onSubmit","onRefreshSession","MessageList","ChatComposer","setText","taRef","useRef","send","readChunkWithAbort","reader","reject","onAbort","parseSseResponse","decoder","buf","event","flush","out","done","idx","line","extractMeta","obj","cid","rid","extractDelta","extractError","streamChat","req","createRes","createData","runId","streamUrl","streamRes","frame","ev","msgType","delta","retryChat","conversationId","messageId","retryRes","retryData","cancelChat","tryLoadMessages","replace","msgs","convo","ChatController","cb","aborter","chatStore","getThreadState","threadId","setThreadStreaming","streaming","setThreadError","upsertMessages","messages","appendMessage","patchMessage","patch","migrateThread","oldId","newId","state","old","byThread","MemoryPanel","KnowledgePanel","VoicePanel","ToolsPanel","enabledPanels","PanelDock","panels","active","close","selected","uuidv4","bytes","hex","normalizeHistory","ChatRoute","setState","setLocalPrefs","flags","anyPanels","existingThreadId","onSend","userId","asstId","cur","onStop","onRetry","lastAsst","convId","SettingsRoute","AdminRoute","parseOrThrow","payload","getDuckDnsStatus","getDuckDnsLogs","limit","base","postDuckDnsUpdate","force","postDuckDnsTest","ip","remediationFor","fmtUnix","fmtIso","OpsRoute","setStatus","logs","setLogs","loading","setLoading","autoRefresh","setAutoRefresh","error","setError","actionNote","setActionNote","loadData","onTest","onForceUpdate","onCopyDiagnostics","bundle","lastErrorCode","remediation","row","listConversations","offset","createConversation","title","renameConversation","deleteConversation","conversationStore","setCurrentConversation","loadConversations","conversations","conversationApi.listConversations","createNewConversation","conversation","conversationApi.createConversation","renameCurrentConversation","currentId","updated","conversationApi.renameConversation","ConversationSidebar","setStore","search","setSearch","editingId","setEditingId","editTitle","setEditTitle","creating","setCreating","filtered","onNewChat","conv","onSelect","startEdit","submitEdit","onDelete","deleteConversationById","conversationApi.deleteConversation","newConversations","formatDate","iso","now","Fragment","parseRoute","clean","routeRequiresAuth","App","setAuth","isAdmin","bootstrap","root","render"],"mappings":"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","x_google_ignoreList":[0,1,2]}